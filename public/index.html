<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ADL - Ad Data Logic Universal Tracking</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { margin: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect } = React;

        function App() {
          const [campaigns, setCampaigns] = useState([]);
          const [loading, setLoading] = useState(false);
          const [activeModal, setActiveModal] = useState(null);
          const [liveStats, setLiveStats] = useState({
            totalCampaigns: 0,
            totalClicks: 0,
            totalConversions: 0,
            totalRevenue: 0
          });

          // Initialize with demo data showing ADL codes
          useEffect(() => {
            const demoCampaigns = [
              {
                id: 'demo_1',
                name: 'Google Summer Sale 2025',
                source: 'google',
                medium: 'cpc',
                budget: 1000,
                code: 'ADL_GG8K2M9X',
                clicks: 1245,
                conversions: 89,
                revenue: 12890,
                status: 'active',
                platforms: ['google'],
                createdAt: new Date().toISOString()
              },
              {
                id: 'demo_2', 
                name: 'Facebook Retargeting Campaign',
                source: 'facebook',
                medium: 'social',
                budget: 500,
                code: 'ADL_FB7N3Q8P',
                clicks: 856,
                conversions: 67,
                revenue: 8970,
                status: 'active',
                platforms: ['facebook'],
                createdAt: new Date().toISOString()
              },
              {
                id: 'demo_3',
                name: 'TikTok Viral Video Campaign',
                source: 'tiktok',
                medium: 'video',
                budget: 750,
                code: 'ADL_TK9R5M2X',
                clicks: 2156,
                conversions: 134,
                revenue: 15670,
                status: 'active',
                platforms: ['tiktok'],
                createdAt: new Date().toISOString()
              }
            ];
            setCampaigns(demoCampaigns);
            updateLiveStats(demoCampaigns);
          }, []);

          // Update live statistics
          const updateLiveStats = (campaignData) => {
            const stats = campaignData.reduce((acc, campaign) => {
              acc.totalClicks += campaign.clicks || 0;
              acc.totalConversions += campaign.conversions || 0;
              acc.totalRevenue += campaign.revenue || 0;
              return acc;
            }, {
              totalCampaigns: campaignData.length,
              totalClicks: 0,
              totalConversions: 0,
              totalRevenue: 0
            });
            setLiveStats(stats);
          };

          // Generate unique ADL tracking code
          const generateADLCode = (source = '') => {
            const prefix = 'ADL_';
            const sourceCode = source ? source.substring(0, 2).toUpperCase() : 'XX';
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
            let random = '';
            for (let i = 0; i < 6; i++) {
              random += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return `${prefix}${sourceCode}${random}`;
          };

          // Create new campaign with unique ADL code
          const createCampaign = async (formData) => {
            setLoading(true);
            try {
              const adlCode = generateADLCode(formData.source);
              
              const newCampaign = {
                id: Date.now().toString(),
                ...formData,
                code: adlCode,
                clicks: 0,
                conversions: 0,
                revenue: 0,
                status: 'active',
                platforms: formData.platforms || [],
                createdAt: new Date().toISOString()
              };
              
              const updatedCampaigns = [...campaigns, newCampaign];
              setCampaigns(updatedCampaigns);
              updateLiveStats(updatedCampaigns);
              localStorage.setItem('adl_campaigns', JSON.stringify(updatedCampaigns));
              
              alert(`🚀 Campaign Created Successfully!\n\n📊 Campaign: ${formData.name}\n🔗 ADL Code: ${adlCode}\n🌐 Platform: ${formData.source || 'Universal'}\n\n💡 Use this ADL code to track conversions across all platforms!`);
            } catch (error) {
              alert('❌ Failed to create campaign: ' + error.message);
            } finally {
              setLoading(false);
            }
          };

          // Copy tracking code to clipboard
          const copyTrackingCode = async (code, platform = 'universal') => {
            const trackingCode = `<!-- ADL Universal Tracking Code -->
<img src="https://track.addatalogic.com/api/track/${code}?platform=${platform}" 
     width="1" height="1" style="display:none" />

<!-- Advanced JavaScript Tracker -->
<script>
window.ADL = {
  track: function(event, data) {
    fetch('https://track.addatalogic.com/api/track/${code}', {
      method: 'POST',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify({
        event: event || 'conversion',
        platform: '${platform}',
        url: window.location.href,
        timestamp: Date.now(),
        ...data
      })
    });
  }
};
ADL.track('pageview');
</script>`;
            
            try {
              await navigator.clipboard.writeText(trackingCode);
              alert(`📋 ADL Tracking Code Copied!\n\n🔗 Code: ${code}\n📊 Platform: ${platform}\n\n💡 Paste this code anywhere to track conversions!`);
            } catch (error) {
              const textArea = document.createElement('textarea');
              textArea.value = trackingCode;
              document.body.appendChild(textArea);
              textArea.select();
              document.execCommand('copy');
              document.body.removeChild(textArea);
              alert(`📋 ADL Tracking Code Copied!\n\n🔗 Code: ${code}`);
            }
          };

          // Export data
          const exportData = () => {
            const csvContent = [
              'Campaign Name,ADL Code,Source,Medium,Budget,Clicks,Conversions,Revenue,Conv Rate,ROI',
              ...campaigns.map(c => {
                const convRate = c.clicks > 0 ? ((c.conversions / c.clicks) * 100).toFixed(2) : 0;
                const roi = c.budget > 0 ? (((c.revenue - c.budget) / c.budget) * 100).toFixed(2) : 0;
                return `"${c.name}","${c.code}","${c.source}","${c.medium}",${c.budget},${c.clicks},${c.conversions},${c.revenue},${convRate}%,${roi}%`;
              })
            ].join('\n');

            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `adl-campaigns-${new Date().toISOString().split('T')[0]}.csv`;
            a.click();
            URL.revokeObjectURL(url);
            alert('📊 Campaign data exported with ADL tracking codes!');
          };

          // View demo
          const viewDemo = () => {
            if (campaigns.length > 0) {
              setActiveModal({ type: 'analytics', campaign: campaigns[0] });
            } else {
              alert('📊 Create a campaign first to see analytics!');
            }
          };

          // Connect platforms
          const connectPlatforms = () => {
            setActiveModal('platforms');
          };

          // Create Campaign Modal
          const CreateCampaignModal = () => {
            const [formData, setFormData] = React.useState({
              name: '', source: '', medium: '', budget: ''
            });

            const handleSubmit = () => {
              if (!formData.name.trim()) {
                alert('❌ Campaign name is required!');
                return;
              }
              createCampaign(formData);
              setActiveModal(null);
            };

            const previewCode = generateADLCode(formData.source);

            return React.createElement('div', {
              className: "fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"
            }, 
              React.createElement('div', {
                className: "bg-white rounded-lg p-6 max-w-md w-full"
              },
                React.createElement('div', {
                  className: "flex justify-between items-center mb-4"
                },
                  React.createElement('h2', {
                    className: "text-xl font-bold"
                  }, "🚀 Create Campaign with ADL Code"),
                  React.createElement('button', {
                    onClick: () => setActiveModal(null),
                    className: "text-gray-500 hover:text-gray-700 text-2xl"
                  }, "×")
                ),
                React.createElement('div', {
                  className: "space-y-4"
                },
                  React.createElement('input', {
                    type: "text",
                    placeholder: "📝 Campaign Name (Required)",
                    value: formData.name,
                    onChange: (e) => setFormData({...formData, name: e.target.value}),
                    className: "w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500"
                  }),
                  React.createElement('select', {
                    value: formData.source,
                    onChange: (e) => setFormData({...formData, source: e.target.value}),
                    className: "w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500"
                  },
                    React.createElement('option', { value: "" }, "🌐 Select Traffic Source"),
                    React.createElement('option', { value: "google" }, "Google Ads"),
                    React.createElement('option', { value: "facebook" }, "Facebook Ads"),
                    React.createElement('option', { value: "tiktok" }, "TikTok Ads"),
                    React.createElement('option', { value: "email" }, "Email Marketing")
                  ),
                  React.createElement('input', {
                    type: "number",
                    placeholder: "💰 Budget ($)",
                    value: formData.budget,
                    onChange: (e) => setFormData({...formData, budget: e.target.value}),
                    className: "w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500"
                  }),
                  React.createElement('div', {
                    className: "bg-blue-50 p-4 rounded-lg"
                  },
                    React.createElement('div', {
                      className: "text-sm font-semibold text-blue-800 mb-2"
                    }, "🔗 Your Auto-Generated ADL Code:"),
                    React.createElement('div', {
                      className: "text-lg font-mono text-blue-600 bg-white p-2 rounded border"
                    }, previewCode),
                    React.createElement('div', {
                      className: "text-xs text-blue-600 mt-2
