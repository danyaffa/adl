<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ADL - Ad Data Logic Universal Tracking</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone@7/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <style>
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        @keyframes progress {
            from { width: 0%; }
            to { width: 100%; }
        }
        .animate-slide-in { animation: slideIn 0.5s ease-out; }
        .animate-pulse-custom { animation: pulse 2s infinite; }
        .progress-bar { animation: progress 2s ease-out; }
        .tooltip {
            visibility: hidden;
            opacity: 0;
            transition: opacity 0.3s, visibility 0.3s;
        }
        .tooltip-trigger:hover .tooltip {
            visibility: visible;
            opacity: 1;
        }
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .glass-effect {
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.9);
        }
        .soft-ad {
            transition: all 0.3s ease;
            border-left: 4px solid #3b82f6;
        }
        .soft-ad:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(59, 130, 246, 0.3);
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;
        
        // User Management & Tier System
        const USER_TIERS = {
            FREE: 'free',
            PRO: 'pro', 
            ENTERPRISE: 'enterprise'
        };

        const TIER_LIMITS = {
            [USER_TIERS.FREE]: {
                campaigns: 3,
                aiGenerations: 5,
                analytics: 'basic',
                support: 'standard',
                features: ['basic_analytics', 'campaign_creation']
            },
            [USER_TIERS.PRO]: {
                campaigns: Infinity,
                aiGenerations: Infinity,
                analytics: 'advanced',
                support: 'priority',
                features: ['advanced_analytics', 'unlimited_ai', 'export', 'ab_testing']
            },
            [USER_TIERS.ENTERPRISE]: {
                campaigns: Infinity,
                aiGenerations: Infinity,
                analytics: 'enterprise',
                support: 'dedicated',
                features: ['team_collaboration', 'custom_integrations', 'white_label', 'api_access']
            }
        };

        const PRICING = {
            [USER_TIERS.PRO]: 29,
            [USER_TIERS.ENTERPRISE]: 99
        };

        // Soft Ad Configuration
        const SOFT_ADS = [
            {
                id: 1,
                logo: "ðŸŽ¨",
                text: "Design stunning ads with Canva Pro - 50% off first month",
                cta: "Try Canva",
                url: "#canva-partner",
                color: "blue"
            },
            {
                id: 2,
                logo: "ðŸ›ï¸",
                text: "Build your store with Shopify - 14-day free trial",
                cta: "Start Free",
                url: "#shopify-partner", 
                color: "green"
            },
            {
                id: 3,
                logo: "ðŸ“š",
                text: "Master digital marketing with Udemy courses - Up to 85% off",
                cta: "Learn Now",
                url: "#udemy-partner",
                color: "purple"
            },
            {
                id: 4,
                logo: "ðŸ“Š",
                text: "Optimize campaigns with Buffer Pro - 30% discount",
                cta: "Get Buffer",
                url: "#buffer-partner",
                color: "indigo"
            }
        ];

        // Mock User State (In real app, this would come from backend)
        const useUser = () => {
            const [user, setUser] = useState({
                id: 'demo_user',
                tier: USER_TIERS.FREE,
                email: null,
                aiGenerationsUsed: 0,
                resetDate: new Date()
            });

            const upgradeTier = (newTier) => {
                setUser(prev => ({ ...prev, tier: newTier }));
            };

            const incrementAiUsage = () => {
                setUser(prev => ({ ...prev, aiGenerationsUsed: prev.aiGenerationsUsed + 1 }));
            };

            const canCreateCampaign = (currentCampaigns) => {
                const limit = TIER_LIMITS[user.tier].campaigns;
                return currentCampaigns < limit;
            };

            const canUseAI = () => {
                const limit = TIER_LIMITS[user.tier].aiGenerations;
                return user.aiGenerationsUsed < limit;
            };

            const hasFeature = (feature) => {
                return TIER_LIMITS[user.tier].features.includes(feature);
            };

            return { user, upgradeTier, incrementAiUsage, canCreateCampaign, canUseAI, hasFeature };
        };

        // Enhanced Analytics Data
        const generateAnalyticsData = () => ({
            clicks: Math.floor(Math.random() * 10000) + 1000,
            conversions: Math.floor(Math.random() * 500) + 100,
            revenue: Math.floor(Math.random() * 50000) + 5000,
            roas: (Math.random() * 8 + 2).toFixed(2),
            ctr: (Math.random() * 5 + 1).toFixed(2),
            cpc: (Math.random() * 3 + 0.5).toFixed(2),
            trend: Math.random() > 0.5 ? 'up' : 'down',
            trendPercent: (Math.random() * 20 + 5).toFixed(1)
        });

        // Main App Component
        function ADLApp() {
            const { user, upgradeTier, incrementAiUsage, canCreateCampaign, canUseAI, hasFeature } = useUser();
            const [campaigns, setCampaigns] = useState([]);
            const [showModal, setShowModal] = useState(false);
            const [showUpgradeModal, setShowUpgradeModal] = useState(false);
            const [showAuthModal, setShowAuthModal] = useState(false);
            const [authMode, setAuthMode] = useState('login');
            const [currentAd, setCurrentAd] = useState(0);
            const [showAd, setShowAd] = useState(true);
            const [showAnalytics, setShowAnalytics] = useState(false);
            const [selectedCampaign, setSelectedCampaign] = useState(null);
            const [showABTest, setShowABTest] = useState(false);
            const [notifications, setNotifications] = useState([]);

            // Rotate soft ads every 8 seconds
            useEffect(() => {
                const interval = setInterval(() => {
                    setCurrentAd(prev => (prev + 1) % SOFT_ADS.length);
                }, 8000);
                return () => clearInterval(interval);
            }, []);

            // Keyboard shortcuts
            useEffect(() => {
                const handleKeyboard = (e) => {
                    if (e.ctrlKey || e.metaKey) {
                        switch(e.key) {
                            case 'n':
                                e.preventDefault();
                                if (canCreateCampaign(campaigns.length)) {
                                    setShowModal(true);
                                } else {
                                    setShowUpgradeModal(true);
                                }
                                break;
                            case 'a':
                                e.preventDefault();
                                if (hasFeature('advanced_analytics')) {
                                    setShowAnalytics(true);
                                }
                                break;
                            case 'e':
                                e.preventDefault();
                                if (hasFeature('export')) {
                                    exportData();
                                }
                                break;
                        }
                    }
                };

                document.addEventListener('keydown', handleKeyboard);
                return () => document.removeEventListener('keydown', handleKeyboard);
            }, [campaigns.length, hasFeature, canCreateCampaign]);

            const addNotification = (message, type = 'info') => {
                const id = Date.now();
                setNotifications(prev => [...prev, { id, message, type }]);
                setTimeout(() => {
                    setNotifications(prev => prev.filter(n => n.id !== id));
                }, 5000);
            };

            const generateADLCode = (source) => {
                const prefix = 'ADL_';
                const sourceCode = source ? source.substring(0, 2).toUpperCase() : 'XX';
                const random = Math.random().toString(36).substring(2, 8).toUpperCase();
                const timestamp = Date.now().toString().slice(-6);
                return `${prefix}${sourceCode}${random}_${timestamp}`;
            };

            const createCampaign = (campaignData) => {
                if (!canCreateCampaign(campaigns.length)) {
                    setShowUpgradeModal(true);
                    return;
                }

                const newCampaign = {
                    id: Date.now(),
                    ...campaignData,
                    adlCode: generateADLCode(campaignData.source),
                    status: 'active',
                    analytics: generateAnalyticsData(),
                    createdAt: new Date().toISOString(),
                    abTests: []
                };

                setCampaigns(prev => [...prev, newCampaign]);
                setShowModal(false);
                addNotification('Campaign created successfully!', 'success');
            };

            const generateAIAd = (platform, budget, objective) => {
                if (!canUseAI()) {
                    setShowUpgradeModal(true);
                    return null;
                }

                incrementAiUsage();

                const templates = {
                    'google-ads': {
                        headline: `Boost Your ROI by 300% | Proven ${objective} Solution`,
                        description: `Get more ${objective.toLowerCase()} with our AI-powered platform. Start your free trial today and see results in 24 hours. No setup fees, cancel anytime.`
                    },
                    'facebook': {
                        headline: `ðŸš€ ${budget > 1000 ? 'Scale' : 'Start'} Your ${objective} Journey`,
                        description: `Join 50,000+ businesses using our platform for ${objective.toLowerCase()}. See why we're rated #1 for ROI optimization.`
                    },
                    'tiktok': {
                        headline: `Viral ${objective} Strategy Inside`,
                        description: `The secret method top brands use for ${objective.toLowerCase()}. Going viral starts here! ðŸ’¥`
                    }
                };

                return templates[platform] || templates['google-ads'];
            };

            const exportData = () => {
                if (!hasFeature('export')) {
                    setShowUpgradeModal(true);
                    return;
                }

                const csvData = campaigns.map(c => ({
                    Campaign: c.name,
                    Source: c.source,
                    Budget: c.budget,
                    ADLCode: c.adlCode,
                    Clicks: c.analytics.clicks,
                    Conversions: c.analytics.conversions,
                    Revenue: c.analytics.revenue,
                    ROAS: c.analytics.roas,
                    CTR: c.analytics.ctr,
                    CPC: c.analytics.cpc
                }));

                const csv = [
                    Object.keys(csvData[0] || {}).join(','),
                    ...csvData.map(row => Object.values(row).join(','))
                ].join('\n');

                const blob = new Blob([csv], { type: 'text/csv' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'adl-campaigns.csv';
                a.click();
                URL.revokeObjectURL(url);

                addNotification('Data exported successfully!', 'success');
            };

            const duplicateCampaign = (campaign) => {
                if (!canCreateCampaign(campaigns.length)) {
                    setShowUpgradeModal(true);
                    return;
                }

                const duplicate = {
                    ...campaign,
                    id: Date.now(),
                    name: `${campaign.name} (Copy)`,
                    adlCode: generateADLCode(campaign.source),
                    analytics: generateAnalyticsData(),
                    createdAt: new Date().toISOString()
                };

                setCampaigns(prev => [...prev, duplicate]);
                addNotification('Campaign duplicated successfully!', 'success');
            };

            const refreshData = () => {
                setCampaigns(prev => prev.map(campaign => ({
                    ...campaign,
                    analytics: generateAnalyticsData()
                })));
                addNotification('Data refreshed!', 'info');
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100">
                    {/* Header */}
                    <header className="glass-effect border-b border-white/20 sticky top-0 z-40">
                        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                            <div className="flex justify-between items-center py-4">
                                <div className="flex items-center space-x-3">
                                    <div className="w-10 h-10 gradient-bg rounded-lg flex items-center justify-center">
                                        <span className="text-white font-bold text-xl">A</span>
                                    </div>
                                    <div>
                                        <h1 className="text-2xl font-bold text-gray-900">ADL Platform</h1>
                                        <p className="text-sm text-gray-600">Universal Ad Tracking & Analytics</p>
                                    </div>
                                </div>

                                <div className="flex items-center space-x-4">
                                    {/* Tier Badge */}
                                    <div className={`px-3 py-1 rounded-full text-xs font-medium ${
                                        user.tier === USER_TIERS.FREE ? 'bg-gray-100 text-gray-800' :
                                        user.tier === USER_TIERS.PRO ? 'bg-blue-100 text-blue-800' :
                                        'bg-purple-100 text-purple-800'
                                    }`}>
                                        {user.tier.toUpperCase()}
                                    </div>

                                    {/* AI Usage Counter */}
                                    {user.tier === USER_TIERS.FREE && (
                                        <div className="text-xs text-gray-600">
                                            AI: {user.aiGenerationsUsed}/{TIER_LIMITS[user.tier].aiGenerations}
                                        </div>
                                    )}

                                    {/* Quick Actions */}
                                    <div className="flex space-x-2">
                                        <button
                                            onClick={refreshData}
                                            className="p-2 text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors tooltip-trigger"
                                        >
                                            <i data-lucide="refresh-cw" className="w-5 h-5"></i>
                                            <div className="tooltip absolute -top-10 left-1/2 transform -translate-x-1/2 bg-black text-white px-2 py-1 rounded text-xs">
                                                Refresh Data (Ctrl+R)
                                            </div>
                                        </button>
                                        
                                        {user.tier === USER_TIERS.FREE ? (
                                            <button
                                                onClick={() => setShowUpgradeModal(true)}
                                                className="px-4 py-2 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg hover:shadow-lg transition-all animate-pulse-custom"
                                            >
                                                Upgrade
                                            </button>
                                        ) : (
                                            <button
                                                onClick={() => setShowAuthModal(true)}
                                                className="px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors"
                                            >
                                                Account
                                            </button>
                                        )}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </header>

                    {/* Notifications */}
                    <div className="fixed top-20 right-4 z-50 space-y-2">
                        {notifications.map(notification => (
                            <div
                                key={notification.id}
                                className={`px-4 py-3 rounded-lg shadow-lg animate-slide-in ${
                                    notification.type === 'success' ? 'bg-green-500 text-white' :
                                    notification.type === 'error' ? 'bg-red-500 text-white' :
                                    'bg-blue-500 text-white'
                                }`}
                            >
                                {notification.message}
                            </div>
                        ))}
                    </div>

                    <main className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
                        {/* Quick Stats */}
                        <div className="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                            <StatsCard
                                title="Active Campaigns"
                                value={campaigns.filter(c => c.status === 'active').length}
                                limit={user.tier === USER_TIERS.FREE ? TIER_LIMITS[user.tier].campaigns : null}
                                icon="target"
                                color="blue"
                            />
                            <StatsCard
                                title="Total Clicks"
                                value={campaigns.reduce((sum, c) => sum + c.analytics.clicks, 0).toLocaleString()}
                                icon="mouse-pointer"
                                color="green"
                            />
                            <StatsCard
                                title="Conversions"
                                value={campaigns.reduce((sum, c) => sum + c.analytics.conversions, 0).toLocaleString()}
                                icon="trending-up"
                                color="purple"
                            />
                            <StatsCard
                                title="Revenue"
                                value={`$${campaigns.reduce((sum, c) => sum + c.analytics.revenue, 0).toLocaleString()}`}
                                icon="dollar-sign"
                                color="yellow"
                            />
                        </div>

                        {/* Action Buttons */}
                        <div className="flex flex-wrap gap-4 mb-8">
                            <button
                                onClick={() => {
                                    if (canCreateCampaign(campaigns.length)) {
                                        setShowModal(true);
                                    } else {
                                        setShowUpgradeModal(true);
                                    }
                                }}
                                className="flex items-center space-x-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors shadow-lg hover:shadow-xl"
                            >
                                <i data-lucide="plus" className="w-5 h-5"></i>
                                <span>Create Campaign</span>
                                <span className="text-xs opacity-75">(Ctrl+N)</span>
                            </button>

                            {hasFeature('advanced_analytics') && (
                                <button
                                    onClick={() => setShowAnalytics(true)}
                                    className="flex items-center space-x-2 px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors"
                                >
                                    <i data-lucide="bar-chart" className="w-5 h-5"></i>
                                    <span>Analytics Dashboard</span>
                                </button>
                            )}

                            {hasFeature('ab_testing') && (
                                <button
                                    onClick={() => setShowABTest(true)}
                                    className="flex items-center space-x-2 px-6 py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors"
                                >
                                    <i data-lucide="git-branch" className="w-5 h-5"></i>
                                    <span>A/B Testing</span>
                                </button>
                            )}

                            {hasFeature('export') && (
                                <button
                                    onClick={exportData}
                                    className="flex items-center space-x-2 px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors"
                                >
                                    <i data-lucide="download" className="w-5 h-5"></i>
                                    <span>Export Data</span>
                                </button>
                            )}
                        </div>

                        {/* Campaigns Grid */}
                        <div className="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6">
                            {campaigns.map(campaign => (
                                <CampaignCard
                                    key={campaign.id}
                                    campaign={campaign}
                                    onDuplicate={() => duplicateCampaign(campaign)}
                                    onAnalytics={() => {
                                        setSelectedCampaign(campaign);
                                        setShowAnalytics(true);
                                    }}
                                    userTier={user.tier}
                                    hasFeature={hasFeature}
                                />
                            ))}

                            {campaigns.length === 0 && (
                                <div className="col-span-full text-center py-12">
                                    <i data-lucide="target" className="w-16 h-16 text-gray-400 mx-auto mb-4"></i>
                                    <h3 className="text-lg font-medium text-gray-900 mb-2">No campaigns yet</h3>
                                    <p className="text-gray-600 mb-6">Create your first campaign to start tracking</p>
                                    <button
                                        onClick={() => setShowModal(true)}
                                        className="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"
                                    >
                                        Create First Campaign
                                    </button>
                                </div>
                            )}
                        </div>
                    </main>

                    {/* Soft Ad Footer */}
                    {showAd && (
                        <div className="fixed bottom-0 left-0 right-0 z-30 soft-ad bg-white border-t shadow-lg">
                            <div className="max-w-6xl mx-auto px-4 py-3">
                                <div className="flex items-center justify-between">
                                    <div className="flex items-center space-x-4">
                                        <div className={`text-2xl ${
                                            SOFT_ADS[currentAd].color === 'blue' ? 'text-blue-500' :
                                            SOFT_ADS[currentAd].color === 'green' ? 'text-green-500' :
                                            SOFT_ADS[currentAd].color === 'purple' ? 'text-purple-500' :
                                            'text-indigo-500'
                                        }`}>
                                            {SOFT_ADS[currentAd].logo}
                                        </div>
                                        <div className="flex-1">
                                            <p className="text-sm text-gray-700">{SOFT_ADS[currentAd].text}</p>
                                        </div>
                                        <button
                                            onClick={() => window.open(SOFT_ADS[currentAd].url, '_blank')}
                                            className={`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${
                                                SOFT_ADS[currentAd].color === 'blue' ? 'bg-blue-100 text-blue-700 hover:bg-blue-200' :
                                                SOFT_ADS[currentAd].color === 'green' ? 'bg-green-100 text-green-700 hover:bg-green-200' :
                                                SOFT_ADS[currentAd].color === 'purple' ? 'bg-purple-100 text-purple-700 hover:bg-purple-200' :
                                                'bg-indigo-100 text-indigo-700 hover:bg-indigo-200'
                                            }`}
                                        >
                                            {SOFT_ADS[currentAd].cta}
                                        </button>
                                    </div>
                                    <button
                                        onClick={() => setShowAd(false)}
                                        className="ml-4 text-gray-400 hover:text-gray-600 p-1"
                                    >
                                        <i data-lucide="x" className="w-4 h-4"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Modals */}
                    {showModal && (
                        <CampaignModal
                            onClose={() => setShowModal(false)}
                            onSave={createCampaign}
                            generateAI={generateAIAd}
                            canUseAI={canUseAI()}
                            userTier={user.tier}
                        />
                    )}

                    {showUpgradeModal && (
                        <UpgradeModal
                            onClose={() => setShowUpgradeModal(false)}
                            currentTier={user.tier}
                            onUpgrade={upgradeTier}
                        />
                    )}

                    {showAnalytics && (
                        <AnalyticsModal
                            onClose={() => setShowAnalytics(false)}
                            campaigns={campaigns}
                            selectedCampaign={selectedCampaign}
                            userTier={user.tier}
                        />
                    )}

                    {showABTest && (
                        <ABTestModal
                            onClose={() => setShowABTest(false)}
                            campaigns={campaigns}
                            userTier={user.tier}
                        />
                    )}

                    {showAuthModal && (
                        <AuthModal
                            onClose={() => setShowAuthModal(false)}
                            mode={authMode}
                            setMode={setAuthMode}
                        />
                    )}
                </div>
            );
        }

        // Stats Card Component
        function StatsCard({ title, value, limit, icon, color }) {
            const colorClasses = {
                blue: 'bg-blue-500',
                green: 'bg-green-500',
                purple: 'bg-purple-500',
                yellow: 'bg-yellow-500'
            };

            return (
                <div className="glass-effect rounded-xl p-6 border border-white/20 hover:shadow-lg transition-shadow">
                    <div className="flex items-center justify-between">
                        <div>
                            <p className="text-sm font-medium text-gray-600">{title}</p>
                            <div className="flex items-center space-x-2">
                                <p className="text-2xl font-bold text-gray-900">{value}</p>
                                {limit && (
                                    <span className="text-sm text-gray-500">/ {limit}</span>
                                )}
                            </div>
                        </div>
                        <div className={`p-3 ${colorClasses[color]} rounded-lg`}>
                            <i data-lucide={icon} className="w-6 h-6 text-white"></i>
                        </div>
                    </div>
                    {limit && (
                        <div className="mt-4">
                            <div className="w-full bg-gray-200 rounded-full h-2">
                                <div
                                    className={`h-2 rounded-full progress-bar ${colorClasses[color]}`}
                                    style={{ width: `${Math.min((value / limit) * 100, 100)}%` }}
                                ></div>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        // Campaign Card Component
        function CampaignCard({ campaign, onDuplicate, onAnalytics, userTier, hasFeature }) {
            const [showTracking, setShowTracking] = useState(false);

            const copyTrackingCode = () => {
                const code = `<script>
window.ADL = {
    track: function(event, data) {
        fetch('https://track.addatalogic.com/api/track/${campaign.adlCode}', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({
                event: event || 'conversion',
                url: window.location.href,
                timestamp: Date.now(),
                ...data
            })
        });
    }
};
ADL.track('pageview');
</script>`;

                navigator.clipboard.writeText(code);
            };

            return (
                <div className="glass-effect rounded-xl p-6 border border-white/20 hover:shadow-lg transition-all animate-slide-in">
                    <div className="flex items-start justify-between mb-4">
                        <div className="flex-1">
                            <h3 className="text-lg font-semibold text-gray-900 mb-1">{campaign.name}</h3>
                            <p className="text-sm text-gray-600">{campaign.source}</p>
                            <p className="text-xs text-gray-500 mt-1">Code: {campaign.adlCode}</p>
                        </div>
                        <div className="flex items-center space-x-2">
                            <span className={`px-2 py-1 rounded-full text-xs font-medium ${
                                campaign.status === 'active' ? 'bg-green-100 text-green-800' : 'bg-gray-100 text-gray-800'
                            }`}>
                                {campaign.status}
                            </span>
                        </div>
                    </div>

                    {/* Performance Metrics */}
                    <div className="grid grid-cols-2 gap-4 mb-4">
                        <div className="text-center">
                            <p className="text-sm text-gray-600">Clicks</p>
                            <p className="text-xl font-bold text-blue-600">{campaign.analytics.clicks.toLocaleString()}</p>
                        </div>
                        <div className="text-center">
                            <p className="text-sm text-gray-600">Conversions</p>
                            <p className="text-xl font-bold text-green-600">{campaign.analytics.conversions.toLocaleString()}</p>
                        </div>
                        <div className="text-center">
                            <p className="text-sm text-gray-600">ROAS</p>
                            <p className="text-lg font-bold text-purple-600">{campaign.analytics.roas}x</p>
                        </div>
                        <div className="text-center">
                            <p className="text-sm text-gray-600">CTR</p>
                            <p className="text-lg font-bold text-orange-600">{campaign.analytics.ctr}%</p>
                        </div>
                    </div>

                    {/* Performance Score */}
                    <div className="mb-4">
                        <div className="flex justify-between items-center mb-2">
                            <span className="text-sm text-gray-600">Performance Score</span>
                            <span className="text-sm font-medium text-gray-900">
                                {Math.floor(campaign.analytics.roas * 20)}%
                            </span>
                        </div>
                        <div className="w-full bg-gray-200 rounded-full h-2">
                            <div
                                className="h-2 bg-gradient-to-r from-green-400 to-blue-500 rounded-full progress-bar"
                                style={{ width: `${Math.min(campaign.analytics.roas * 20, 100)}%` }}
                            ></div>
                        </div>
                    </div>

                    {/* Action Buttons */}
                    <div className="flex flex-wrap gap-2">
                        <button
                            onClick={() => setShowTracking(!showTracking)}
                            className="flex-1 px-3 py-2 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition-colors text-sm"
                        >
                            <i data-lucide="code" className="w-4 h-4 inline mr-1"></i>
                            Tracking
                        </button>

                        {hasFeature('advanced_analytics') && (
                            <button
                                onClick={onAnalytics}
                                className="flex-1 px-3 py-2 bg-purple-100 text-purple-700 rounded-lg hover:bg-purple-200 transition-colors text-sm"
                            >
                                <i data-lucide="bar-chart" className="w-4 h-4 inline mr-1"></i>
                                Analytics
                            </button>
                        )}

                        <button
                            onClick={onDuplicate}
                            className="px-3 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors text-sm"
                        >
                            <i data-lucide="copy" className="w-4 h-4"></i>
                        </button>
                    </div>

                    {/* Tracking Code Display */}
                    {showTracking && (
                        <div className="mt-4 p-3 bg-gray-900 rounded-lg">
                            <div className="flex justify-between items-center mb-2">
                                <span className="text-green-400 text-sm font-mono">Universal Tracking Code</span>
                                <button
                                    onClick={copyTrackingCode}
                                    className="px-2 py-1 bg-green-600 text-white rounded text-xs hover:bg-green-700"
                                >
                                    Copy
                                </button>
                            </div>
                            <pre className="text-green-400 text-xs overflow-x-auto">
{`<script>
window.ADL = {
  track: function(event, data) {
    fetch('https://track.addatalogic.com/api/track/${campaign.adlCode}', {
      method: 'POST',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify({
        event: event || 'conversion',
        url: window.location.href,
        timestamp: Date.now(),
        ...data
      })
    });
  }
};
ADL.track('pageview');
</script>`}
                            </pre>
                        </div>
                    )}
                </div>
            );
        }

        // Campaign Creation Modal
        function CampaignModal({ onClose, onSave, generateAI, canUseAI, userTier }) {
            const [formData, setFormData] = useState({
                name: '',
                source: '',
                budget: '',
                objective: 'conversions'
            });
            const [aiContent, setAiContent] = useState(null);
            const [loading, setLoading] = useState(false);

            const platforms = [
                'google-ads', 'facebook', 'instagram', 'tiktok', 'linkedin', 'twitter',
                'youtube', 'pinterest', 'snapchat', 'reddit', 'quora', 'bing-ads',
                'amazon-ads', 'shopify-ads', 'etsy-ads', 'ebay-ads', 'apple-search',
                'spotify-ads', 'twitch-ads', 'discord-ads', 'telegram-ads', 'wechat-ads',
                'baidu-ads', 'yandex-ads', 'native-ads'
            ];

            const handleAIGenerate = async () => {
                if (!canUseAI) return;
                
                setLoading(true);
                setTimeout(() => {
                    const content = generateAI(formData.source, formData.budget, formData.objective);
                    setAiContent(content);
                    setLoading(false);
                }, 1500);
            };

            const handleSubmit = (e) => {
                e.preventDefault();
                if (!formData.name || !formData.source || !formData.budget) return;

                onSave({
                    ...formData,
                    budget: parseFloat(formData.budget),
                    aiContent
                });
            };

            return (
                <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
                    <div className="bg-white rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto">
                        <div className="p-6 border-b">
                            <div className="flex justify-between items-center">
                                <h2 className="text-xl font-bold text-gray-900">Create New Campaign</h2>
                                <button
                                    onClick={onClose}
                                    className="text-gray-400 hover:text-gray-600"
                                >
                                    <i data-lucide="x" className="w-6 h-6"></i>
                                </button>
                            </div>
                        </div>

                        <form onSubmit={handleSubmit} className="p-6 space-y-6">
                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-2">
                                    Campaign Name *
                                </label>
                                <input
                                    type="text"
                                    value={formData.name}
                                    onChange={(e) => setFormData(prev => ({ ...prev, name: e.target.value }))}
                                    className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                    placeholder="Enter campaign name"
                                    required
                                />
                            </div>

                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-2">
                                    Ad Platform *
                                </label>
                                <select
                                    value={formData.source}
                                    onChange={(e) => setFormData(prev => ({ ...prev, source: e.target.value }))}
                                    className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                    required
                                >
                                    <option value="">Select platform</option>
                                    {platforms.map(platform => (
                                        <option key={platform} value={platform}>
                                            {platform.replace('-', ' ').replace(/\b\w/g, l => l.toUpperCase())}
                                        </option>
                                    ))}
                                </select>
                            </div>

                            <div className="grid grid-cols-2 gap-4">
                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">
                                        Budget ($) *
                                    </label>
                                    <input
                                        type="number"
                                        value={formData.budget}
                                        onChange={(e) => setFormData(prev => ({ ...prev, budget: e.target.value }))}
                                        className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                        placeholder="1000"
                                        min="1"
                                        required
                                    />
                                </div>

                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">
                                        Objective
                                    </label>
                                    <select
                                        value={formData.objective}
                                        onChange={(e) => setFormData(prev => ({ ...prev, objective: e.target.value }))}
                                        className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                    >
                                        <option value="conversions">Conversions</option>
                                        <option value="traffic">Traffic</option>
                                        <option value="awareness">Brand Awareness</option>
                                        <option value="engagement">Engagement</option>
                                        <option value="leads">Lead Generation</option>
                                    </select>
                                </div>
                            </div>

                            {/* AI Ad Generator */}
                            <div className="border rounded-lg p-4 bg-gradient-to-r from-purple-50 to-blue-50">
                                <div className="flex justify-between items-center mb-3">
                                    <h3 className="font-medium text-gray-900">AI Ad Generator</h3>
                                    {canUseAI ? (
                                        <button
                                            type="button"
                                            onClick={handleAIGenerate}
                                            disabled={loading || !formData.source}
                                            className="px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"
                                        >
                                            {loading ? (
                                                <div className="flex items-center space-x-2">
                                                    <div className="w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"></div>
                                                    <span>Generating...</span>
                                                </div>
                                            ) : (
                                                <>
                                                    <i data-lucide="sparkles" className="w-4 h-4 inline mr-1"></i>
                                                    Generate AI Ad
                                                </>
                                            )}
                                        </button>
                                    ) : (
                                        <div className="text-sm text-gray-500">
                                            Upgrade for AI features
                                        </div>
                                    )}
                                </div>

                                {aiContent && (
                                    <div className="space-y-3">
                                        <div>
                                            <label className="text-sm font-medium text-gray-700">Headline</label>
                                            <p className="text-gray-900 bg-white p-2 rounded border">{aiContent.headline}</p>
                                        </div>
                                        <div>
                                            <label className="text-sm font-medium text-gray-700">Description</label>
                                            <p className="text-gray-900 bg-white p-2 rounded border">{aiContent.description}</p>
                                        </div>
                                    </div>
                                )}
                            </div>

                            <div className="flex justify-end space-x-3 pt-4 border-t">
                                <button
                                    type="button"
                                    onClick={onClose}
                                    className="px-4 py-2 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors"
                                >
                                    Cancel
                                </button>
                                <button
                                    type="submit"
                                    className="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"
                                >
                                    Create Campaign
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            );
        }

        // Upgrade Modal
        function UpgradeModal({ onClose, currentTier, onUpgrade }) {
            const handleUpgrade = (tier) => {
                // In real app, this would integrate with payment processor
                onUpgrade(tier);
                onClose();
            };

            return (
                <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
                    <div className="bg-white rounded-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto">
                        <div className="p-6 border-b">
                            <div className="flex justify-between items-center">
                                <h2 className="text-2xl font-bold text-gray-900">Upgrade Your ADL Plan</h2>
                                <button onClick={onClose} className="text-gray-400 hover:text-gray-600">
                                    <i data-lucide="x" className="w-6 h-6"></i>
                                </button>
                            </div>
                            <p className="text-gray-600 mt-2">Choose the plan that fits your business needs</p>
                        </div>

                        <div className="p-6">
                            <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                                {/* Free Tier */}
                                <div className={`border rounded-xl p-6 ${currentTier === USER_TIERS.FREE ? 'border-blue-500 bg-blue-50' : 'border-gray-200'}`}>
                                    <div className="text-center mb-6">
                                        <h3 className="text-xl font-bold text-gray-900">Free</h3>
                                        <div className="text-3xl font-bold text-gray-900 mt-2">$0</div>
                                        <div className="text-gray-600">Perfect for getting started</div>
                                    </div>

                                    <ul className="space-y-3 mb-6">
                                        <li className="flex items-center space-x-2">
                                            <i data-lucide="check" className="w-4 h-4 text-green-500"></i>
                                            <span className="text-sm">3 campaigns maximum</span>
                                        </li>
                                        <li className="flex items-center space-x-2">
                                            <i data-lucide="check" className="w-4 h-4 text-green-500"></i>
                                            <span className="text-sm">Basic analytics</span>
                                        </li>
                                        <li className="flex items-center space-x-2">
                                            <i data-lucide="check" className="w-4 h-4 text-green-500"></i>
                                            <span className="text-sm">5 AI generations/month</span>
                                        </li>
                                        <li className="flex items-center space-x-2">
                                            <i data-lucide="check" className="w-4 h-4 text-green-500"></i>
                                            <span className="text-sm">Standard support</span>
                                        </li>
                                    </ul>

                                    {currentTier === USER_TIERS.FREE ? (
                                        <div className="w-full py-2 bg-blue-100 text-blue-800 rounded-lg text-center font-medium">
                                            Current Plan
                                        </div>
                                    ) : (
                                        <button
                                            onClick={() => handleUpgrade(USER_TIERS.FREE)}
                                            className="w-full py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors"
                                        >
                                            Downgrade
                                        </button>
                                    )}
                                </div>

                                {/* Pro Tier */}
                                <div className={`border rounded-xl p-6 relative ${currentTier === USER_TIERS.PRO ? 'border-blue-500 bg-blue-50' : 'border-gray-200'}`}>
                                    <div className="absolute -top-3 left-1/2 transform -translate-x-1/2">
                                        <span className="bg-blue-600 text-white px-3 py-1 rounded-full text-xs font-medium">
                                            Most Popular
                                        </span>
                                    </div>

                                    <div className="text-center mb-6">
                                        <h3 className="text-xl font-bold text-gray-900">Pro</h3>
                                        <div className="text-3xl font-bold text-gray-900 mt-2">$29</div>
                                        <div className="text-gray-600">per month</div>
                                    </div>

                                    <ul className="space-y-3 mb-6">
                                        <li className="flex items-center space-x-2">
                                            <i data-lucide="check" className="w-4 h-4 text-green-500"></i>
                                            <span className="text-sm">Unlimited campaigns</span>
                                        </li>
                                        <li className="flex items-center space-x-2">
                                            <i data-lucide="check" className="w-4 h-4 text-green-500"></i>
                                            <span className="text-sm">Advanced analytics</span>
                                        </li>
                                        <li className="flex items-center space-x-2">
                                            <i data-lucide="check" className="w-4 h-4 text-green-500"></i>
                                            <span className="text-sm">Unlimited AI generation</span>
                                        </li>
                                        <li className="flex items-center space-x-2">
                                            <i data-lucide="check" className="w-4 h-4 text-green-500"></i>
                                            <span className="text-sm">A/B testing suite</span>
                                        </li>
                                        <li className="flex items-center space-x-2">
                                            <i data-lucide="check" className="w-4 h-4 text-green-500"></i>
                                            <span className="text-sm">Export features</span>
                                        </li>
                                        <li className="flex items-center space-x-2">
                                            <i data-lucide="check" className="w-4 h-4 text-green-500"></i>
                                            <span className="text-sm">Priority support</span>
                                        </li>
                                    </ul>

                                    {currentTier === USER_TIERS.PRO ? (
                                        <div className="w-full py-2 bg-blue-100 text-blue-800 rounded-lg text-center font-medium">
                                            Current Plan
                                        </div>
                                    ) : (
                                        <button
                                            onClick={() => handleUpgrade(USER_TIERS.PRO)}
                                            className="w-full py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium"
                                        >
                                            Upgrade to Pro
                                        </button>
                                    )}
                                </div>

                                {/* Enterprise Tier */}
                                <div className={`border rounded-xl p-6 ${currentTier === USER_TIERS.ENTERPRISE ? 'border-blue-500 bg-blue-50' : 'border-gray-200'}`}>
                                    <div className="text-center mb-6">
                                        <h3 className="text-xl font-bold text-gray-900">Enterprise</h3>
                                        <div className="text-3xl font-bold text-gray-900 mt-2">$99</div>
                                        <div className="text-gray-600">per month</div>
                                    </div>

                                    <ul className="space-y-3 mb-6">
                                        <li className="flex items-center space-x-2">
                                            <i data-lucide="check" className="w-4 h-4 text-green-500"></i>
                                            <span className="text-sm">Everything in Pro</span>
                                        </li>
                                        <li className="flex items-center space-x-2">
                                            <i data-lucide="check" className="w-4 h-4 text-green-500"></i>
                                            <span className="text-sm">Team collaboration</span>
                                        </li>
                                        <li className="flex items-center space-x-2">
                                            <i data-lucide="check" className="w-4 h-4 text-green-500"></i>
                                            <span className="text-sm">Custom integrations</span>
                                        </li>
                                        <li className="flex items-center space-x-2">
                                            <i data-lucide="check" className="w-4 h-4 text-green-500"></i>
                                            <span className="text-sm">White-label options</span>
                                        </li>
                                        <li className="flex items-center space-x-2">
                                            <i data-lucide="check" className="w-4 h-4 text-green-500"></i>
                                            <span className="text-sm">API access</span>
                                        </li>
                                        <li className="flex items-center space-x-2">
                                            <i data-lucide="check" className="w-4 h-4 text-green-500"></i>
                                            <span className="text-sm">Dedicated support</span>
                                        </li>
                                    </ul>

                                    {currentTier === USER_TIERS.ENTERPRISE ? (
                                        <div className="w-full py-2 bg-blue-100 text-blue-800 rounded-lg text-center font-medium">
                                            Current Plan
                                        </div>
                                    ) : (
                                        <button
                                            onClick={() => handleUpgrade(USER_TIERS.ENTERPRISE)}
                                            className="w-full py-2 bg-gradient-to-r from-purple-600 to-blue-600 text-white rounded-lg hover:shadow-lg transition-all font-medium"
                                        >
                                            Upgrade to Enterprise
                                        </button>
                                    )}
                                </div>
                            </div>

                            <div className="mt-8 text-center">
                                <p className="text-gray-600">All plans include universal tracking across 25+ platforms</p>
                                <p className="text-sm text-gray-500 mt-2">Cancel anytime. No setup fees.</p>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        // Analytics Modal (Advanced)
        function AnalyticsModal({ onClose, campaigns, selectedCampaign, userTier }) {
            const [timeRange, setTimeRange] = useState('7d');
            const [selectedMetric, setSelectedMetric] = useState('revenue');

            const data = selectedCampaign ? [selectedCampaign] : campaigns;
            
            const totalMetrics = data.reduce((acc, campaign) => ({
                clicks: acc.clicks + campaign.analytics.clicks,
                conversions: acc.conversions + campaign.analytics.conversions,
                revenue: acc.revenue + campaign.analytics.revenue,
                spend: acc.spend + campaign.budget
            }), { clicks: 0, conversions: 0, revenue: 0, spend: 0 });

            const avgROAS = totalMetrics.spend > 0 ? (totalMetrics.revenue / totalMetrics.spend).toFixed(2) : 0;
            const conversionRate = totalMetrics.clicks > 0 ? ((totalMetrics.conversions / totalMetrics.clicks) * 100).toFixed(2) : 0;

            return (
                <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
                    <div className="bg-white rounded-xl max-w-6xl w-full max-h-[90vh] overflow-y-auto">
                        <div className="p-6 border-b">
                            <div className="flex justify-between items-center">
                                <div>
                                    <h2 className="text-2xl font-bold text-gray-900">Analytics Dashboard</h2>
                                    <p className="text-gray-600">
                                        {selectedCampaign ? `Campaign: ${selectedCampaign.name}` : `All Campaigns (${campaigns.length})`}
                                    </p>
                                </div>
                                <button onClick={onClose} className="text-gray-400 hover:text-gray-600">
                                    <i data-lucide="x" className="w-6 h-6"></i>
                                </button>
                            </div>
                        </div>

                        <div className="p-6">
                            {/* Time Range Selector */}
                            <div className="flex space-x-4 mb-6">
                                {['7d', '30d', '90d', '1y'].map(range => (
                                    <button
                                        key={range}
                                        onClick={() => setTimeRange(range)}
                                        className={`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${
                                            timeRange === range
                                                ? 'bg-blue-600 text-white'
                                                : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                                        }`}
                                    >
                                        {range.replace('d', ' days').replace('y', ' year')}
                                    </button>
                                ))}
                            </div>

                            {/* Key Metrics */}
                            <div className="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                                <div className="bg-gradient-to-r from-blue-500 to-blue-600 rounded-xl p-6 text-white">
                                    <div className="flex items-center justify-between">
                                        <div>
                                            <p className="text-blue-100">Total Revenue</p>
                                            <p className="text-2xl font-bold">${totalMetrics.revenue.toLocaleString()}</p>
                                        </div>
                                        <i data-lucide="dollar-sign" className="w-8 h-8 text-blue-200"></i>
                                    </div>
                                    <div className="mt-2 flex items-center text-blue-100">
                                        <i data-lucide="trending-up" className="w-4 h-4 mr-1"></i>
                                        <span className="text-sm">+12.5% vs last period</span>
                                    </div>
                                </div>

                                <div className="bg-gradient-to-r from-green-500 to-green-600 rounded-xl p-6 text-white">
                                    <div className="flex items-center justify-between">
                                        <div>
                                            <p className="text-green-100">ROAS</p>
                                            <p className="text-2xl font-bold">{avgROAS}x</p>
                                        </div>
                                        <i data-lucide="target" className="w-8 h-8 text-green-200"></i>
                                    </div>
                                    <div className="mt-2 flex items-center text-green-100">
                                        <i data-lucide="trending-up" className="w-4 h-4 mr-1"></i>
                                        <span className="text-sm">Above industry avg</span>
                                    </div>
                                </div>

                                <div className="bg-gradient-to-r from-purple-500 to-purple-600 rounded-xl p-6 text-white">
                                    <div className="flex items-center justify-between">
                                        <div>
                                            <p className="text-purple-100">Conversion Rate</p>
                                            <p className="text-2xl font-bold">{conversionRate}%</p>
                                        </div>
                                        <i data-lucide="zap" className="w-8 h-8 text-purple-200"></i>
                                    </div>
                                    <div className="mt-2 flex items-center text-purple-100">
                                        <i data-lucide="trending-up" className="w-4 h-4 mr-1"></i>
                                        <span className="text-sm">+5.2% improvement</span>
                                    </div>
                                </div>

                                <div className="bg-gradient-to-r from-orange-500 to-orange-600 rounded-xl p-6 text-white">
                                    <div className="flex items-center justify-between">
                                        <div>
                                            <p className="text-orange-100">Total Conversions</p>
                                            <p className="text-2xl font-bold">{totalMetrics.conversions.toLocaleString()}</p>
                                        </div>
                                        <i data-lucide="users" className="w-8 h-8 text-orange-200"></i>
                                    </div>
