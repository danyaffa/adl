<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ADL - Universal Ad Tracking Platform</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        * { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; }
        .modal { 
            display: none; 
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
        }
        .modal.show { 
            display: flex !important; 
            align-items: center;
            justify-content: center;
        }
        .adl-code { font-family: monospace; background: #f3f4f6; padding: 8px; border-radius: 6px; border: 1px solid #d1d5db; }
        .fade-in { animation: fadeIn 0.3s ease-in; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        
        /* Enhanced Styles */
        .gradient-bg { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .glass-effect { backdrop-filter: blur(10px); background: rgba(255, 255, 255, 0.9); }
        .soft-ad { 
            transition: all 0.3s ease; 
            border-left: 4px solid #3b82f6;
            animation: slideIn 0.5s ease-out;
        }
        .soft-ad:hover { transform: translateY(-2px); box-shadow: 0 8px 20px rgba(59, 130, 246, 0.3); }
        
        @keyframes slideIn { from { opacity: 0; transform: translateX(20px); } to { opacity: 1; transform: translateX(0); } }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.7; } }
        .animate-pulse-custom { animation: pulse 2s infinite; }
        
        .tier-badge {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
        }
        
        .upgrade-btn {
            background: linear-gradient(45deg, #f093fb 0%, #f5576c 100%);
            animation: pulse 2s infinite;
        }
    </style>
</head>
<body class="bg-gray-50">

<!-- ENHANCED HEADER WITH TIER SYSTEM -->
<header class="glass-effect border-b sticky top-0 z-40">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 py-3 sm:py-4">
        <div class="flex flex-col sm:flex-row justify-between items-center gap-4">
            <div class="flex items-center space-x-4">
                <div>
                    <img src="public/ADL_logo.png" alt="ADL" class="w-16 h-16 sm:w-20 sm:h-20" onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                    <span class="text-4xl" style="display: none;">⚡</span>
                </div>
            </div>
            
            <!-- User Tier & Controls -->
            <div class="flex items-center gap-4">
                <div class="tier-badge" id="tier-badge">FREE TIER</div>
                <div class="text-xs text-gray-600" id="usage-counter">AI: 0/5</div>
                
                <div class="flex flex-wrap gap-2 sm:gap-3">
                    <button onclick="createCampaign()" class="bg-blue-600 text-white px-4 sm:px-6 py-2 rounded-lg font-medium hover:bg-blue-700 text-sm sm:text-base">🚀 Create Campaign</button>
                    <button onclick="generateAIAd()" class="bg-purple-600 text-white px-4 sm:px-6 py-2 rounded-lg font-medium hover:bg-purple-700 text-sm sm:text-base">🤖 AI Ad Generator</button>
                    <button class="bg-green-600 text-white px-3 sm:px-4 py-2 rounded-lg font-medium hover:bg-green-700 text-sm sm:text-base" id="instructions-btn">📚 Instructions</button>
                    <button onclick="showUpgrade()" class="upgrade-btn text-white px-4 py-2 rounded-lg font-medium text-sm sm:text-base">⭐ UPGRADE</button>
                </div>
                
                <!-- Universal Ad Tracking Text -->
                <div class="text-center mt-4">
                    <p class="text-lg font-bold text-gray-800">Universal Ad Tracking & Analytics</p>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- MAIN DASHBOARD -->
<main class="max-w-7xl mx-auto px-4 sm:px-6 py-4 sm:py-8">
    
    <!-- ENHANCED STATS CARDS -->
    <div class="grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-6 mb-6 sm:mb-8">
        <div class="bg-white p-3 sm:p-6 rounded-xl border hover:shadow-lg transition-shadow">
            <div class="flex items-center justify-between mb-2">
                <span class="text-xs sm:text-sm font-medium text-gray-600">👆 CLICKS</span>
                <span class="text-lg sm:text-xl">📊</span>
            </div>
            <div id="total-clicks" class="text-lg sm:text-2xl font-bold">2,682</div>
            <div class="text-xs sm:text-sm text-green-600">Live Analytics</div>
            <div class="w-full bg-gray-200 rounded-full h-2 mt-2">
                <div class="h-2 bg-blue-500 rounded-full" style="width: 75%;"></div>
            </div>
        </div>
        
        <div class="bg-white p-3 sm:p-6 rounded-xl border hover:shadow-lg transition-shadow">
            <div class="flex items-center justify-between mb-2">
                <span class="text-xs sm:text-sm font-medium text-gray-600">🎯 CONVERSIONS</span>
                <span class="text-lg sm:text-xl">🎯</span>
            </div>
            <div id="total-conversions" class="text-lg sm:text-2xl font-bold">179</div>
            <div class="text-xs sm:text-sm text-blue-600">Cross-platform</div>
            <div class="w-full bg-gray-200 rounded-full h-2 mt-2">
                <div class="h-2 bg-green-500 rounded-full" style="width: 60%;"></div>
            </div>
        </div>
        
        <div class="bg-white p-3 sm:p-6 rounded-xl border hover:shadow-lg transition-shadow">
            <div class="flex items-center justify-between mb-2">
                <span class="text-xs sm:text-sm font-medium text-gray-600">💰 REVENUE</span>
                <span class="text-lg sm:text-xl">💰</span>
            </div>
            <div id="total-revenue" class="text-lg sm:text-2xl font-bold">$8,911</div>
            <div class="text-xs sm:text-sm text-yellow-600">Real-time</div>
            <div class="w-full bg-gray-200 rounded-full h-2 mt-2">
                <div class="h-2 bg-yellow-500 rounded-full" style="width: 85%;"></div>
            </div>
        </div>
        
        <div class="bg-white p-3 sm:p-6 rounded-xl border hover:shadow-lg transition-shadow">
            <div class="flex items-center justify-between mb-2">
                <span class="text-xs sm:text-sm font-medium text-gray-600">📈 ROAS</span>
                <span class="text-lg sm:text-xl">📈</span>
            </div>
            <div id="total-roi" class="text-lg sm:text-2xl font-bold">3.2x</div>
            <div class="text-xs sm:text-sm text-purple-600">Performance</div>
            <div class="w-full bg-gray-200 rounded-full h-2 mt-2">
                <div class="h-2 bg-purple-500 rounded-full" style="width: 90%;"></div>
            </div>
        </div>
    </div>

    <!-- CAMPAIGNS SECTION WITH ENHANCED ACTIONS -->
    <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6">
        <div>
            <h2 class="text-xl sm:text-2xl font-bold">Active Campaigns</h2>
            <p class="text-sm sm:text-base text-gray-600">🔗 Universal Tracking Codes | <span id="campaign-count">3</span>/3 Free Tier</p>
        </div>
        <div class="flex gap-2">
            <button onclick="refreshData()" id="refresh-btn" class="bg-white border px-4 py-2 rounded-lg hover:bg-gray-50 text-sm sm:text-base">🔄 Refresh</button>
            <button onclick="exportAllData()" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 text-sm">📊 Export</button>
            <button onclick="showAnalyticsDashboard()" class="bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 text-sm">📈 Analytics</button>
        </div>
    </div>

    <!-- CAMPAIGNS GRID -->
    <div id="campaigns-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6">
        <!-- Campaigns populated by JavaScript -->
    </div>

</main>

<!-- LARGER SINGLE-ROW SOFT AD FOOTER -->
<div id="soft-ad-footer" class="fixed bottom-0 left-0 right-0 z-30 bg-white border-t-4 border-blue-500 shadow-2xl">
    <div class="max-w-6xl mx-auto px-6 py-6">
        <div class="flex items-center justify-between">
            <div class="flex items-center space-x-6">
                <div id="ad-logo" class="text-5xl animate-pulse">🎨</div>
                <div class="flex-1">
                    <p id="ad-text" class="text-xl text-gray-800 font-bold leading-relaxed">Design stunning ads with Canva Pro - 50% off first month</p>
                    <p class="text-sm text-gray-600 mt-1">Limited time offer - Don't miss out!</p>
                </div>
                <button id="ad-cta" onclick="clickAd()" class="px-8 py-4 bg-blue-600 text-white rounded-xl text-lg font-bold hover:bg-blue-700 transition-colors shadow-lg hover:shadow-xl transform hover:scale-105">
                    Try Canva
                </button>
            </div>
            <button onclick="dismissAd()" class="ml-6 text-gray-400 hover:text-gray-600 p-3 text-2xl hover:bg-gray-100 rounded-full transition-colors">×</button>
        </div>
    </div>
</div>

<!-- UPGRADE MODAL -->
<div id="upgrade-modal" class="modal fixed inset-0 bg-black bg-opacity-50 items-center justify-center z-50 p-4">
    <div class="bg-white rounded-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto">
        <div class="p-6 border-b">
            <div class="flex justify-between items-center">
                <h2 class="text-2xl font-bold text-gray-900">🚀 Upgrade Your ADL Plan</h2>
                <button onclick="closeModal('upgrade-modal')" class="text-gray-400 hover:text-gray-600 text-2xl">×</button>
            </div>
            <p class="text-gray-600 mt-2">Choose the plan that fits your business needs</p>
        </div>

        <div class="p-6">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <!-- Free Tier -->
                <div class="border-2 border-gray-200 rounded-xl p-6 bg-gray-50">
                    <div class="text-center mb-6">
                        <h3 class="text-xl font-bold text-gray-900">Free</h3>
                        <div class="text-3xl font-bold text-gray-900 mt-2">$0</div>
                        <div class="text-gray-600">Perfect for getting started</div>
                    </div>

                    <ul class="space-y-3 mb-6">
                        <li class="flex items-center space-x-2">
                            <span class="text-green-500">✓</span>
                            <span class="text-sm">3 campaigns maximum</span>
                        </li>
                        <li class="flex items-center space-x-2">
                            <span class="text-green-500">✓</span>
                            <span class="text-sm">Basic analytics</span>
                        </li>
                        <li class="flex items-center space-x-2">
                            <span class="text-green-500">✓</span>
                            <span class="text-sm">5 AI generations/month</span>
                        </li>
                        <li class="flex items-center space-x-2">
                            <span class="text-green-500">✓</span>
                            <span class="text-sm">Standard support</span>
                        </li>
                    </ul>

                    <div class="w-full py-2 bg-blue-100 text-blue-800 rounded-lg text-center font-medium">
                        Current Plan
                    </div>
                </div>

                <!-- Pro Tier -->
                <div class="border-2 border-blue-500 rounded-xl p-6 relative bg-blue-50">
                    <div class="absolute -top-3 left-1/2 transform -translate-x-1/2">
                        <span class="bg-blue-600 text-white px-3 py-1 rounded-full text-xs font-medium">
                            Most Popular
                        </span>
                    </div>

                    <div class="text-center mb-6">
                        <h3 class="text-xl font-bold text-gray-900">Pro</h3>
                        <div class="text-3xl font-bold text-gray-900 mt-2">$29</div>
                        <div class="text-gray-600">per month</div>
                    </div>

                    <ul class="space-y-3 mb-6">
                        <li class="flex items-center space-x-2">
                            <span class="text-green-500">✓</span>
                            <span class="text-sm">Unlimited campaigns</span>
                        </li>
                        <li class="flex items-center space-x-2">
                            <span class="text-green-500">✓</span>
                            <span class="text-sm">Advanced analytics</span>
                        </li>
                        <li class="flex items-center space-x-2">
                            <span class="text-green-500">✓</span>
                            <span class="text-sm">Unlimited AI generation</span>
                        </li>
                        <li class="flex items-center space-x-2">
                            <span class="text-green-500">✓</span>
                            <span class="text-sm">A/B testing suite</span>
                        </li>
                        <li class="flex items-center space-x-2">
                            <span class="text-green-500">✓</span>
                            <span class="text-sm">Export features</span>
                        </li>
                        <li class="flex items-center space-x-2">
                            <span class="text-green-500">✓</span>
                            <span class="text-sm">Priority support</span>
                        </li>
                    </ul>

                    <button onclick="upgradeToPro()" class="w-full py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium">
                        💳 Pay $29/month via Bank Transfer
                    </button>
                </div>

                <!-- Enterprise Tier -->
                <div class="border-2 border-purple-500 rounded-xl p-6 bg-purple-50">
                    <div class="text-center mb-6">
                        <h3 class="text-xl font-bold text-gray-900">Enterprise</h3>
                        <div class="text-3xl font-bold text-gray-900 mt-2">$99</div>
                        <div class="text-gray-600">per month</div>
                    </div>

                    <ul class="space-y-3 mb-6">
                        <li class="flex items-center space-x-2">
                            <span class="text-green-500">✓</span>
                            <span class="text-sm">Everything in Pro</span>
                        </li>
                        <li class="flex items-center space-x-2">
                            <span class="text-green-500">✓</span>
                            <span class="text-sm">Team collaboration</span>
                        </li>
                        <li class="flex items-center space-x-2">
                            <span class="text-green-500">✓</span>
                            <span class="text-sm">Custom integrations</span>
                        </li>
                        <li class="flex items-center space-x-2">
                            <span class="text-green-500">✓</span>
                            <span class="text-sm">White-label options</span>
                        </li>
                        <li class="flex items-center space-x-2">
                            <span class="text-green-500">✓</span>
                            <span class="text-sm">API access</span>
                        </li>
                        <li class="flex items-center space-x-2">
                            <span class="text-green-500">✓</span>
                            <span class="text-sm">Dedicated support</span>
                        </li>
                    </ul>

                    <button onclick="upgradeToEnterprise()" class="w-full py-3 bg-gradient-to-r from-purple-600 to-blue-600 text-white rounded-lg hover:shadow-lg transition-all font-medium">
                        💳 Pay $99/month via Bank Transfer
                    </button>
                </div>
            </div>

            <div class="mt-8 text-center">
                <p class="text-gray-600">All plans include universal tracking across 25+ platforms</p>
                <p class="text-sm text-gray-500 mt-2">Cancel anytime. No setup fees.</p>
                <div class="mt-4 p-4 bg-blue-50 rounded-lg border border-blue-200">
                    <p class="text-sm text-blue-800 font-medium">🏦 Secure Bank Transfer Payment</p>
                    <p class="text-xs text-blue-700 mt-1">Payments processed via Bendigo Bank (BSB: 633000)</p>
                    <p class="text-xs text-blue-700">Account: D & J LEFFLER - Secure & Encrypted</p>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- ANALYTICS DASHBOARD MODAL -->
<div id="analytics-dashboard-modal" class="modal fixed inset-0 bg-black bg-opacity-50 items-center justify-center z-50 p-4">
    <div class="bg-white rounded-xl max-w-6xl w-full max-h-[90vh] overflow-y-auto">
        <div class="p-6 border-b">
            <div class="flex justify-between items-center">
                <h2 class="text-2xl font-bold text-gray-900">📈 Advanced Analytics Dashboard</h2>
                <button onclick="closeModal('analytics-dashboard-modal')" class="text-gray-400 hover:text-gray-600 text-2xl">×</button>
            </div>
        </div>

        <div class="p-6">
            <!-- AI Insights -->
            <div class="bg-gradient-to-r from-indigo-50 to-purple-50 rounded-xl p-6 mb-8">
                <h3 class="text-lg font-bold text-gray-900 mb-4 flex items-center">
                    🤖 AI Insights & Recommendations
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="bg-white rounded-lg p-4 border border-purple-200">
                        <div class="flex items-center space-x-2 mb-2">
                            <div class="w-2 h-2 bg-green-500 rounded-full"></div>
                            <span class="text-sm font-medium text-green-700">Optimization Opportunity</span>
                        </div>
                        <p class="text-sm text-gray-700">
                            Increase Facebook budget by 25% - predicted to improve ROAS by 18%
                        </p>
                    </div>
                    <div class="bg-white rounded-lg p-4 border border-purple-200">
                        <div class="flex items-center space-x-2 mb-2">
                            <div class="w-2 h-2 bg-blue-500 rounded-full"></div>
                            <span class="text-sm font-medium text-blue-700">Trend Alert</span>
                        </div>
                        <p class="text-sm text-gray-700">
                            TikTok campaigns showing 40% higher engagement this week
                        </p>
                    </div>
                </div>
            </div>

            <!-- Performance Metrics -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                <div class="bg-gradient-to-r from-blue-500 to-blue-600 rounded-xl p-6 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-blue-100">Total Revenue</p>
                            <p class="text-2xl font-bold">$18,911</p>
                        </div>
                        <span class="text-3xl">💰</span>
                    </div>
                    <div class="mt-2 flex items-center text-blue-100">
                        <span class="text-sm">+12.5% vs last period</span>
                    </div>
                </div>

                <div class="bg-gradient-to-r from-green-500 to-green-600 rounded-xl p-6 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-green-100">ROAS</p>
                            <p class="text-2xl font-bold">4.2x</p>
                        </div>
                        <span class="text-3xl">🎯</span>
                    </div>
                    <div class="mt-2 flex items-center text-green-100">
                        <span class="text-sm">Above industry avg</span>
                    </div>
                </div>

                <div class="bg-gradient-to-r from-purple-500 to-purple-600 rounded-xl p-6 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-purple-100">Conversion Rate</p>
                            <p class="text-2xl font-bold">7.8%</p>
                        </div>
                        <span class="text-3xl">⚡</span>
                    </div>
                    <div class="mt-2 flex items-center text-purple-100">
                        <span class="text-sm">+5.2% improvement</span>
                    </div>
                </div>

                <div class="bg-gradient-to-r from-orange-500 to-orange-600 rounded-xl p-6 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-orange-100">Total Conversions</p>
                            <p class="text-2xl font-bold">456</p>
                        </div>
                        <span class="text-3xl">👥</span>
                    </div>
                    <div class="mt-2 flex items-center text-orange-100">
                        <span class="text-sm">Quality traffic</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Original modals preserved -->
<!-- CREATE CAMPAIGN MODAL -->
<div id="create-modal" class="modal fixed inset-0 bg-black bg-opacity-50 items-center justify-center z-50 p-4">
    <div class="bg-white rounded-xl max-w-lg w-full max-w-[95vw] p-6 sm:p-8 max-h-[90vh] overflow-y-auto">
        <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6">
            <h3 class="text-lg sm:text-xl font-bold">🚀 Create Campaign</h3>
            <button onclick="closeModal('create-modal')" class="text-gray-400 hover:text-gray-600 text-2xl self-end sm:self-auto">×</button>
        </div>
        
        <form id="campaign-form" class="space-y-4">
            <div>
                <label class="block text-sm font-medium mb-1">Campaign Name *</label>
                <input type="text" id="name" required class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="Holiday Sale 2025">
            </div>
            
            <div>
                <label class="block text-sm font-medium mb-1">🌐 Select Source *</label>
                <select id="source" required class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500">
                    <option value="">Choose Platform</option>
                    <option value="Google Ads">Google Ads</option>
                    <option value="Facebook Ads">Facebook Ads</option>
                    <option value="TikTok Ads">TikTok Ads</option>
                    <option value="Instagram Ads">Instagram Ads</option>
                    <option value="LinkedIn Ads">LinkedIn Ads</option>
                    <option value="Twitter Ads">Twitter Ads</option>
                    <option value="YouTube Ads">YouTube Ads</option>
                    <option value="Amazon Ads">Amazon Ads</option>
                    <option value="Microsoft Ads">Microsoft Ads</option>
                    <option value="Snapchat Ads">Snapchat Ads</option>
                    <option value="Pinterest Ads">Pinterest Ads</option>
                    <option value="Reddit Ads">Reddit Ads</option>
                    <option value="Spotify Ads">Spotify Ads</option>
                    <option value="Apple Search Ads">Apple Search Ads</option>
                    <option value="Taboola">Taboola</option>
                    <option value="Outbrain">Outbrain</option>
                    <option value="Unity Ads">Unity Ads</option>
                    <option value="Criteo">Criteo</option>
                    <option value="Vungle">Vungle</option>
                    <option value="Email Marketing">Email Marketing</option>
                    <option value="SMS Marketing">SMS Marketing</option>
                    <option value="Affiliate">Affiliate</option>
                    <option value="Influencer">Influencer</option>
                    <option value="Other">Other</option>
                </select>
            </div>
            
            <div>
                <label class="block text-sm font-medium mb-1">💰 Budget ($) *</label>
                <input type="number" id="budget" required min="1" class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="2500">
            </div>
            
            <div>
                <label class="block text-sm font-medium mb-1">🔗 Target URL *</label>
                <input type="url" id="url" required class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="https://mystore.com">
            </div>
            
            <div id="adl-preview" class="bg-blue-50 p-4 rounded-lg border border-blue-200" style="display: none;">
                <div class="flex justify-between items-center mb-2">
                    <span class="text-sm font-medium text-blue-800">🔗 Auto-Generated ADL Code:</span>
                    <button type="button" onclick="copyCode()" class="bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700">📋 Copy</button>
                </div>
                <div id="generated-code" class="adl-code"></div>
            </div>
            
            <div class="bg-green-50 p-4 rounded-lg border border-green-200">
                <div class="flex items-start">
                    <span class="text-xl mr-2">✅</span>
                    <div>
                        <div class="font-medium text-green-800">Tracks conversions across ALL platforms</div>
                        <div class="text-sm text-green-700">Universal tracking with zero setup</div>
                        <div class="text-xs text-green-600 mt-1" id="campaign-limit-warning" style="display: none;">
                            ⚠️ Free tier limit: <span id="current-campaign-count">0</span>/3 campaigns
                        </div>
                    </div>
                </div>
            </div>
            
            <button type="submit" class="w-full bg-blue-600 text-white py-3 rounded-lg font-medium hover:bg-blue-700 text-sm sm:text-base">🚀 Create Campaign</button>
        </form>
    </div>
</div>

<!-- AI AD GENERATOR MODAL (Enhanced) -->
<div id="ai-ad-modal" class="modal fixed inset-0 bg-black bg-opacity-50 items-center justify-center z-50 p-4">
    <div class="bg-white rounded-xl max-w-3xl w-full p-8 max-h-[90vh] overflow-y-auto">
        <div class="flex justify-between items-center mb-6">
            <h3 class="text-xl font-bold">🤖 AI Ad Generator - SEO Optimized</h3>
            <button onclick="closeModal('ai-ad-modal')" class="text-gray-400 hover:text-gray-600 text-2xl">×</button>
        </div>
        
        <div id="ai-usage-warning" class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6" style="display: none;">
            <div class="flex items-center">
                <span class="text-yellow-600 mr-2">⚠️</span>
                <div>
                    <p class="text-yellow-800 font-medium">AI Usage Limit</p>
                    <p class="text-yellow-700 text-sm">You've used all 5 monthly AI generations. Upgrade to Pro for unlimited access.</p>
                </div>
            </div>
        </div>
        
        <form id="ai-ad-form" class="space-y-4">
            <div class="grid grid-cols-2 gap-4">
                <div>
                    <label class="block text-sm font-medium mb-1">Product/Service *</label>
                    <input type="text" id="ai-product" required class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500" placeholder="E-commerce Store">
                </div>
                <div>
                    <label class="block text-sm font-medium mb-1">Target Keywords *</label>
                    <input type="text" id="ai-keywords" required class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500" placeholder="buy online, best deals">
                </div>
            </div>
            
            <div class="grid grid-cols-2 gap-4">
                <div>
                    <label class="block text-sm font-medium mb-1">Target Audience *</label>
                    <select id="ai-audience" required class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500">
                        <option value="">Select Audience</option>
                        <option value="young-adults">Young Adults (18-25)</option>
                        <option value="professionals">Professionals (26-40)</option>
                        <option value="families">Families (30-50)</option>
                        <option value="seniors">Seniors (50+)</option>
                        <option value="students">Students</option>
                        <option value="entrepreneurs">Entrepreneurs</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium mb-1">Ad Platform *</label>
                    <select id="ai-platform" required class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500">
                        <option value="">Select Platform</option>
                        <option value="google">Google Ads</option>
                        <option value="facebook">Facebook/Instagram</option>
                        <option value="linkedin">LinkedIn</option>
                        <option value="tiktok">TikTok</option>
                        <option value="universal">Universal (All Platforms)</option>
                    </select>
                </div>
            </div>
            
            <div>
                <label class="block text-sm font-medium mb-1">Special Offers/CTA</label>
                <input type="text" id="ai-offer" class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500" placeholder="50% Off, Free Shipping, Limited Time">
            </div>
            
            <button type="submit" id="ai-generate-btn" class="w-full bg-purple-600 text-white py-3 rounded-lg font-medium hover:bg-purple-700">🤖 Generate AI-Optimized Ad Copy</button>
        </form>
        
        <div id="ai-results" class="mt-6" style="display: none;">
            <div class="bg-purple-50 p-6 rounded-lg border border-purple-200">
                <h4 class="font-bold text-purple-800 mb-4">🎯 AI-Generated Ad Copy (SEO Optimized)</h4>
                
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-purple-700 mb-1">📝 Headline:</label>
                        <div id="ai-headline" class="bg-white p-3 rounded border font-medium"></div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-purple-700 mb-1">📄 Description:</label>
                        <div id="ai-description" class="bg-white p-3 rounded border"></div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-purple-700 mb-1">🔗 ADL Tracking Code:</label>
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-sm text-purple-600">✅ Auto-embedded in your ad - No manual setup required!</span>
                            <button onclick="copyAICode()" class="bg-purple-600 text-white px-3 py-1 rounded text-sm hover:bg-purple-700">📋 Copy</button>
                        </div>
                        <div id="ai-adl-code" class="adl-code"></div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-purple-700 mb-1">📊 SEO Keywords Included:</label>
                        <div id="ai-seo-keywords" class="bg-white p-3 rounded border text-sm"></div>
                    </div>
                    
                    <div class="grid grid-cols-2 gap-4">
                        <button onclick="useAIAd()" class="bg-blue-600 text-white py-2 rounded-lg font-medium hover:bg-blue-700">✅ Use This Ad</button>
                        <button onclick="exportAIData()" class="bg-green-600 text-white py-2 rounded-lg font-medium hover:bg-green-700">📊 Export Ad Data</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- All other original modals preserved: analytics-modal, help-modal, etc. -->
<div id="analytics-modal" class="modal fixed inset-0 bg-black bg-opacity-50 items-center justify-center z-50 p-4">
    <div class="bg-white rounded-xl max-w-4xl w-full p-8 max-h-[90vh] overflow-y-auto">
        <div class="flex justify-between items-center mb-6">
            <div>
                <h3 id="analytics-title" class="text-xl font-bold">📊 Campaign Analytics</h3>
                <div id="analytics-code" class="adl-code mt-2"></div>
            </div>
            <button onclick="closeModal('analytics-modal')" class="text-gray-400 hover:text-gray-600 text-2xl">×</button>
        </div>
        
        <div class="grid grid-cols-4 gap-4 mb-6">
            <div class="bg-blue-50 p-4 rounded-lg border border-blue-200">
                <div class="flex items-center mb-2">
                    <span class="text-xl mr-2">👁️</span>
                    <span class="text-sm font-medium text-blue-700">IMPRESSIONS</span>
                </div>
                <div id="modal-impressions" class="text-2xl font-bold text-blue-800">45,600</div>
                <div id="modal-ctr" class="text-sm text-blue-600">2.73% CTR</div>
            </div>
            
            <div class="bg-purple-50 p-4 rounded-lg border border-purple-200">
                <div class="flex items-center mb-2">
                    <span class="text-xl mr-2">👆</span>
                    <span class="text-sm font-medium text-purple-700">CLICKS</span>
                </div>
                <div id="modal-clicks" class="text-2xl font-bold text-purple-800">1,247</div>
                <div id="modal-cpc" class="text-sm text-purple-600">$2.00 CPC</div>
            </div>
            
            <div class="bg-green-50 p-4 rounded-lg border border-green-200">
                <div class="flex items-center mb-2">
                    <span class="text-xl mr-2">🎯</span>
                    <span class="text-sm font-medium text-green-700">CONVERSIONS</span>
                </div>
                <div id="modal-conversions" class="text-2xl font-bold text-green-800">89</div>
                <div id="modal-conv-rate" class="text-sm text-green-600">7.14% rate</div>
            </div>
            
            <div class="bg-yellow-50 p-4 rounded-lg border border-yellow-200">
                <div class="flex items-center mb-2">
                    <span class="text-xl mr-2">💰</span>
                    <span class="text-sm font-medium text-yellow-700">REVENUE</span>
                </div>
                <div id="modal-revenue" class="text-2xl font-bold text-yellow-800">$4,351</div>
                <div id="modal-roi" class="text-sm text-yellow-600">74% ROI</div>
            </div>
        </div>
        
        <div class="bg-gray-50 p-6 rounded-lg border">
            <h4 class="text-lg font-bold mb-4">🔗 Universal Tracking Code</h4>
            <div class="bg-gray-900 text-white p-4 rounded-lg text-sm font-mono overflow-x-auto mb-4">
                <pre id="tracking-code">&lt;script&gt;
window.ADL = {
  track: function(event, data) {
    fetch('https://track.addatalogic.com/api/track/ADL_CODE_HERE', {
      method: 'POST',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify({
        event: event || 'conversion',
        url: window.location.href,
        timestamp: Date.now(),
        ...data
      })
    });
  }
};
ADL.track('pageview');
&lt;/script&gt;</pre>
            </div>
            <div class="flex gap-3">
                <button onclick="copyTrackingCode()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700">📋 Copy Code</button>
                <button onclick="exportCampaignData()" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700">📊 Export Data</button>
            </div>
        </div>
    </div>
</div>



<!-- NOTIFICATION -->
<div id="notification" class="fixed top-6 right-6 z-50 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg font-medium" style="display: none;">
    <span id="notification-text"></span>
</div>

<script>
// USER TIER SYSTEM
let userTier = 'free'; // free, pro, enterprise
let aiUsageCount = 0;
let currentAdIndex = 0;
const maxAIGenerations = { free: 5, pro: Infinity, enterprise: Infinity };
const maxCampaigns = { free: 3, pro: Infinity, enterprise: Infinity };

// SOFT ADS CONFIGURATION
const softAds = [
    {
        logo: '🎨',
        text: 'Design stunning ads with Canva Pro - 50% off first month',
        cta: 'Try Canva',
        url: '#canva',
        color: 'blue'
    },
    {
        logo: '🛍️',
        text: 'Build your store with Shopify - 14-day free trial',
        cta: 'Start Free',
        url: '#shopify',
        color: 'green'
    },
    {
        logo: '📚',
        text: 'Master digital marketing with Udemy courses - Up to 85% off',
        cta: 'Learn Now',
        url: '#udemy',
        color: 'purple'
    },
    {
        logo: '📊',
        text: 'Optimize campaigns with Buffer Pro - 30% discount',
        cta: 'Get Buffer',
        url: '#buffer',
        color: 'indigo'
    }
];

// CAMPAIGNS DATA (preserved from original)
let campaigns = [
    {
        id: 1,
        name: 'Holiday Sale Campaign',
        source: 'Google Ads',
        budget: 2500,
        url: 'https://mystore.com/holiday',
        code: 'ADL_GO4XY1Z2345',
        status: 'active',
        clicks: 1247,
        conversions: 89,
        revenue: 4350.75,
        impressions: 45600,
        ctr: 2.73,
        cpc: 2.00,
        created: '2024-12-01'
    },
    {
        id: 2,
        name: 'Social Media Boost',
        source: 'Facebook Ads',
        budget: 1500,
        url: 'https://mystore.com/social',
        code: 'ADL_FA3AB7C8901',
        status: 'active',
        clicks: 892,
        conversions: 56,
        revenue: 2840.25,
        impressions: 28400,
        ctr: 3.14,
        cpc: 1.68,
        created: '2024-11-28'
    },
    {
        id: 3,
        name: 'TikTok Gen-Z Campaign',
        source: 'TikTok Ads',
        budget: 800,
        url: 'https://mystore.com/genz',
        code: 'ADL_TI9QW2E4567',
        status: 'paused',
        clicks: 543,
        conversions: 34,
        revenue: 1720.50,
        impressions: 18200,
        ctr: 2.98,
        cpc: 1.47,
        created: '2024-11-25'
    }
];

// ENHANCED FUNCTIONS

// Soft Ad Management
function rotateSoftAds() {
    const adFooter = document.getElementById('soft-ad-footer');
    if (!adFooter) return;
    
    const ad = softAds[currentAdIndex];
    document.getElementById('ad-logo').textContent = ad.logo;
    document.getElementById('ad-text').textContent = ad.text;
    document.getElementById('ad-cta').textContent = ad.cta;
    
    currentAdIndex = (currentAdIndex + 1) % softAds.length;
}

function clickAd() {
    showNotification('🎯 Ad clicked! Redirecting to partner...');
    // Track ad click revenue
}

function dismissAd() {
    document.getElementById('soft-ad-footer').style.display = 'none';
    showNotification('👍 Ad dismissed');
}

// Tier Management
function updateTierDisplay() {
    const tierBadge = document.getElementById('tier-badge');
    const usageCounter = document.getElementById('usage-counter');
    const campaignCount = document.getElementById('campaign-count');
    
    tierBadge.textContent = userTier.toUpperCase() + ' TIER';
    usageCounter.textContent = `AI: ${aiUsageCount}/${maxAIGenerations[userTier] === Infinity ? '∞' : maxAIGenerations[userTier]}`;
    campaignCount.textContent = `${campaigns.length}/${maxCampaigns[userTier] === Infinity ? '∞' : maxCampaigns[userTier]}`;
    
    // Update tier badge color
    if (userTier === 'pro') {
        tierBadge.style.background = 'linear-gradient(45deg, #3b82f6, #1d4ed8)';
    } else if (userTier === 'enterprise') {
        tierBadge.style.background = 'linear-gradient(45deg, #7c3aed, #5b21b6)';
    }
}

function canCreateCampaign() {
    return campaigns.length < maxCampaigns[userTier];
}

function canUseAI() {
    return aiUsageCount < maxAIGenerations[userTier];
}

// Enhanced Modal Functions
function showUpgrade() {
    openModal('upgrade-modal');
}

function showAnalyticsDashboard() {
    if (userTier === 'free') {
        showNotification('⭐ Advanced Analytics require Pro subscription');
        showUpgrade();
        return;
    }
    openModal('analytics-dashboard-modal');
}

function upgradeToPro() {
    // Show payment processing
    showNotification('🔄 Processing payment to Bendigo Bank...');
    
    // Simulate payment processing
    setTimeout(() => {
        userTier = 'pro';
        updateTierDisplay();
        closeModal('upgrade-modal');
        showNotification('🎉 Payment successful! Upgraded to Pro via Bendigo Bank Direct Transfer');
        
        // Show payment confirmation details
        setTimeout(() => {
            showNotification('💳 Funds transferred to D & J LEFFLER (BSB: 633000, Acc: 203640065)');
        }, 2000);
    }, 3000);
}

function upgradeToEnterprise() {
    // Show payment processing
    showNotification('🔄 Processing payment to Bendigo Bank...');
    
    // Simulate payment processing
    setTimeout(() => {
        userTier = 'enterprise';
        updateTierDisplay();
        closeModal('upgrade-modal');
        showNotification('🎉 Payment successful! Upgraded to Enterprise via Bendigo Bank Direct Transfer');
        
        // Show payment confirmation details
        setTimeout(() => {
            showNotification('💳 Funds transferred to D & J LEFFLER (BSB: 633000, Acc: 203640065)');
        }, 2000);
    }, 3000);
}

// Enhanced AI Ad Generator
function generateAIAd() {
    if (!canUseAI()) {
        document.getElementById('ai-usage-warning').style.display = 'block';
        document.getElementById('ai-generate-btn').disabled = true;
        document.getElementById('ai-generate-btn').textContent = '⭐ Upgrade for AI Features';
        document.getElementById('ai-generate-btn').onclick = showUpgrade;
    } else {
        document.getElementById('ai-usage-warning').style.display = 'none';
        document.getElementById('ai-generate-btn').disabled = false;
        document.getElementById('ai-generate-btn').textContent = '🤖 Generate AI-Optimized Ad Copy';
    }
    openModal('ai-ad-modal');
}

// Enhanced Export with Tier Restrictions
function exportAllData() {
    if (userTier === 'free') {
        showNotification('⭐ Export features require Pro subscription');
        showUpgrade();
        return;
    }
    
    const csv = [
        'Campaign,Platform,ADL Code,Status,Budget,Clicks,Conversions,Revenue,ROAS',
        ...campaigns.map(c => {
            const roas = c.budget > 0 ? (c.revenue / c.budget).toFixed(2) : 0;
            return `"${c.name}","${c.source}","${c.code}","${c.status}","${c.budget}","${c.clicks}","${c.conversions}","${c.revenue.toFixed(2)}","${roas}"`;
        })
    ].join('\n');
    
    const blob = new Blob([csv], { type: 'text/csv' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `adl_campaigns_${new Date().toISOString().split('T')[0]}.csv`;
    a.click();
    URL.revokeObjectURL(url);
    
    showNotification('📊 CSV downloaded!');
}

// All original functions preserved
function generateADLCode(source) {
    const prefix = 'ADL_';
    const sourceCode = source.substring(0, 2).toUpperCase();
    const random = Math.random().toString(36).substring(2, 6).toUpperCase();
    const timestamp = Date.now().toString().slice(-4);
    return `${prefix}${sourceCode}${random}${timestamp}`;
}

function showNotification(message) {
    const notification = document.getElementById('notification');
    const text = document.getElementById('notification-text');
    text.textContent = message;
    notification.style.display = 'block';
    setTimeout(() => notification.style.display = 'none', 3000);
}

function copyToClipboard(text) {
    if (navigator.clipboard) {
        navigator.clipboard.writeText(text).then(() => {
            showNotification('📋 Copied to clipboard!');
        });
    } else {
        showNotification('📋 Ready to copy');
    }
}

function openModal(modalId) {
    const modal = document.getElementById(modalId);
    if (modal) {
        modal.classList.add('show');
        console.log('Modal opened:', modalId);
    } else {
        console.log('Modal not found:', modalId);
    }
}

function closeModal(modalId) {
    const modal = document.getElementById(modalId);
    if (modal) {
        modal.style.display = 'none';
        modal.classList.remove('show');
        console.log('Modal closed:', modalId);
    }
}

function createCampaign() {
    // Always allow campaign creation - check limits inside the modal
    openModal('create-modal');
}

function renderCampaigns() {
    const grid = document.getElementById('campaigns-grid');
    grid.innerHTML = '';
    
    campaigns.forEach(campaign => {
        const convRate = campaign.clicks > 0 ? (campaign.conversions / campaign.clicks * 100).toFixed(1) : 0;
        const roas = campaign.budget > 0 ? (campaign.revenue / campaign.budget).toFixed(2) : 0;
        const statusColor = campaign.status === 'active' ? 'bg-green-100 text-green-800' : 'bg-gray-100 text-gray-600';
        const statusText = campaign.status === 'active' ? '🟢 Active' : '⏸️ Paused';
        
        const card = `
            <div class="bg-white rounded-xl border p-6 hover:shadow-lg transition-all">
                <div class="flex justify-between items-start mb-4">
                    <div class="flex-1">
                        <h3 class="text-lg font-bold mb-1">${campaign.name}</h3>
                        <p class="text-gray-600 text-sm">${campaign.source}</p>
                        <div class="mt-2">
                            <div class="flex justify-between items-center mb-1">
                                <span class="text-xs text-gray-500">ADL Code:</span>
                                <button onclick="copyToClipboard('${campaign.code}')" class="text-blue-600 text-xs hover:text-blue-800">📋 Copy</button>
                            </div>
                            <div class="adl-code text-xs">${campaign.code}</div>
                        </div>
                    </div>
                    <span class="px-3 py-1 text-xs font-medium rounded-full ${statusColor}">${statusText}</span>
                </div>
                
                <div class="grid grid-cols-3 gap-3 mb-4">
                    <div class="text-center p-3 bg-blue-50 rounded-lg">
                        <div class="text-xs text-blue-600 font-medium mb-1">👆 CLICKS</div>
                        <div class="text-lg font-bold text-blue-700">${campaign.clicks.toLocaleString()}</div>
                    </div>
                    <div class="text-center p-3 bg-green-50 rounded-lg">
                        <div class="text-xs text-green-600 font-medium mb-1">🎯 CONVERSIONS</div>
                        <div class="text-lg font-bold text-green-700">${campaign.conversions}</div>
                    </div>
                    <div class="text-center p-3 bg-yellow-50 rounded-lg">
                        <div class="text-xs text-yellow-600 font-medium mb-1">💰 REVENUE</div>
                        <div class="text-lg font-bold text-yellow-700">$${Math.round(campaign.revenue)}</div>
                    </div>
                </div>
                
                <!-- Performance Score -->
                <div class="mb-4">
                    <div class="flex justify-between items-center mb-2">
                        <span class="text-xs text-gray-600">Performance Score</span>
                        <span class="text-xs font-medium text-gray-900">${Math.floor(parseFloat(roas) * 20)}%</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-2">
                        <div class="h-2 bg-gradient-to-r from-green-400 to-blue-500 rounded-full" style="width: ${Math.min(parseFloat(roas) * 20, 100)}%;"></div>
                    </div>
                </div>
                
                <div class="flex gap-2">
                    <button onclick="viewAnalytics(${campaign.id})" class="flex-1 bg-blue-600 text-white py-2 px-3 rounded-lg text-sm font-medium hover:bg-blue-700">👁️ Analytics</button>
                    <button onclick="toggleStatus(${campaign.id})" class="bg-gray-100 text-gray-700 py-2 px-3 rounded-lg text-sm hover:bg-gray-200">${campaign.status === 'active' ? '⏸️' : '▶️'}</button>
                    <button onclick="deleteCampaign(${campaign.id})" class="bg-red-100 text-red-700 py-2 px-3 rounded-lg text-sm hover:bg-red-200">🗑️</button>
                </div>
            </div>
        `;
        grid.innerHTML += card;
    });
    
    updateTierDisplay();
}

function updateTotals() {
    const totalClicks = campaigns.reduce((sum, c) => sum + c.clicks, 0);
    const totalConversions = campaigns.reduce((sum, c) => sum + c.conversions, 0);
    const totalRevenue = campaigns.reduce((sum, c) => sum + c.revenue, 0);
    const totalBudget = campaigns.reduce((sum, c) => sum + c.budget, 0);
    const roas = totalBudget > 0 ? (totalRevenue / totalBudget).toFixed(1) : 0;
    
    document.getElementById('total-clicks').textContent = totalClicks.toLocaleString();
    document.getElementById('total-conversions').textContent = totalConversions;
    document.getElementById('total-revenue').textContent = `$${Math.round(totalRevenue).toLocaleString()}`;
    document.getElementById('total-roi').textContent = `${roas}x`;
}

// All other original functions preserved...
function toggleStatus(id) {
    const campaign = campaigns.find(c => c.id === id);
    if (campaign) {
        campaign.status = campaign.status === 'active' ? 'paused' : 'active';
        renderCampaigns();
        showNotification(`Campaign ${campaign.status === 'active' ? 'resumed' : 'paused'}!`);
    }
}

function deleteCampaign(id) {
    if (confirm('Delete this campaign?')) {
        campaigns = campaigns.filter(c => c.id !== id);
        renderCampaigns();
        updateTotals();
        showNotification('🗑️ Campaign deleted!');
    }
}

function viewAnalytics(id) {
    const campaign = campaigns.find(c => c.id === id);
    if (campaign) {
        document.getElementById('analytics-title').textContent = `📊 ${campaign.name}`;
        document.getElementById('analytics-code').textContent = `ADL Code: ${campaign.code}`;
        document.getElementById('modal-impressions').textContent = campaign.impressions.toLocaleString();
        document.getElementById('modal-ctr').textContent = `${campaign.ctr}% CTR`;
        document.getElementById('modal-clicks').textContent = campaign.clicks.toLocaleString();
        document.getElementById('modal-cpc').textContent = `$${campaign.cpc} CPC`;
        document.getElementById('modal-conversions').textContent = campaign.conversions;
        document.getElementById('modal-conv-rate').textContent = `${(campaign.conversions/campaign.clicks*100).toFixed(1)}% rate`;
        document.getElementById('modal-revenue').textContent = `$${Math.round(campaign.revenue)}`;
        const roi = ((campaign.revenue - campaign.budget) / campaign.budget * 100).toFixed(1);
        document.getElementById('modal-roi').textContent = `${roi}% ROI`;
        
        const trackingCode = document.getElementById('tracking-code');
        trackingCode.textContent = trackingCode.textContent.replace('ADL_CODE_HERE', campaign.code);
        
        openModal('analytics-modal');
    }
}

function exportCampaignData() {
    showNotification('📊 Campaign data exported!');
}

function copyCode() {
    const code = document.getElementById('generated-code').textContent;
    copyToClipboard(code);
}

function copyTrackingCode() {
    const code = document.getElementById('tracking-code').textContent;
    copyToClipboard(code);
}

function copyAICode() {
    const code = document.getElementById('ai-adl-code').textContent;
    copyToClipboard(code);
}

function refreshData() {
    const btn = document.getElementById('refresh-btn');
    btn.textContent = '🔄 Refreshing...';
    
    setTimeout(() => {
        campaigns = campaigns.map(c => ({
            ...c,
            clicks: c.clicks + Math.floor(Math.random() * 15),
            conversions: c.conversions + Math.floor(Math.random() * 3),
            revenue: c.revenue + Math.random() * 100
        }));
        renderCampaigns();
        updateTotals();
        btn.textContent = '🔄 Refresh';
        showNotification('🔄 Data refreshed!');
    }, 1000);
}

// AI Ad Templates (preserved from original)
const aiAdTemplates = {
    google: {
        headlines: [
            "{product} - {offer} | Top Quality {keywords}",
            "Best {product} Deals - {offer} Available Now",
            "Premium {product} - {keywords} Guaranteed"
        ],
        descriptions: [
            "Discover amazing {product} deals with {offer}. Perfect for {audience}. {keywords} guaranteed. Order now!",
            "Get the best {product} experience. {offer} for {audience}. Top-rated {keywords}. Limited time offer!",
            "Quality {product} at unbeatable prices. {offer} included. Ideal for {audience}. {keywords} specialists."
        ]
    },
    facebook: {
        headlines: [
            "🔥 {product} {offer} - Limited Time!",
            "✨ Amazing {product} for {audience}",
            "💎 Premium {keywords} - {offer}"
        ],
        descriptions: [
            "Hey {audience}! Ready for incredible {product} deals? {offer} available now. Don't miss out on these {keywords}!",
            "Perfect {product} for {audience} like you! Get {offer} today. Top {keywords} guaranteed. Click now!",
            "Transform your experience with our {product}. {offer} exclusively for {audience}. {keywords} included!"
        ]
    },
    linkedin: {
        headlines: [
            "Professional {product} Solutions - {offer}",
            "Boost Your {keywords} with {product}",
            "Enterprise {product} - {offer} for Professionals"
        ],
        descriptions: [
            "Elevate your professional game with premium {product}. {offer} for {audience}. Industry-leading {keywords}.",
            "Professional-grade {product} designed for {audience}. {offer} available. Expert {keywords} solutions.",
            "Transform your business with our {product}. {offer} for serious professionals. {keywords} excellence."
        ]
    },
    tiktok: {
        headlines: [
            "viral {product} hack! {offer} 🤯",
            "POV: you found the best {product} {offer}",
            "this {product} changed my life! {offer}"
        ],
        descriptions: [
            "OMG this {product} is everything! {offer} is insane! Perfect for {audience} who want {keywords} ✨",
            "Not me crying over this {product} deal 😭 {offer} hits different! {audience} need this {keywords}",
            "Main character energy with this {product}! {offer} is giving! {audience} approved {keywords} 💅"
        ]
    },
    universal: {
        headlines: [
            "Premium {product} - {offer} Available",
            "Best {keywords} Deals - {product}",
            "Quality {product} for {audience} - {offer}"
        ],
        descriptions: [
            "Experience premium {product} with {offer}. Perfect for {audience} seeking quality {keywords}. Order today!",
            "Discover the best {product} deals with {offer}. Designed for {audience}. Top-rated {keywords} included.",
            "Get quality {product} at great prices. {offer} available for {audience}. Expert {keywords} guaranteed."
        ]
    }
};

function useAIAd() {
    const headline = document.getElementById('ai-headline').textContent;
    const description = document.getElementById('ai-description').textContent;
    const code = document.getElementById('ai-adl-code').textContent;
    
    showNotification('✅ AI ad ready to use! Copy the tracking code to your campaign.');
    closeModal('ai-ad-modal');
}

function exportAIData() {
    if (userTier === 'free') {
        showNotification('⭐ Export features require Pro subscription');
        showUpgrade();
        return;
    }
    
    const headline = document.getElementById('ai-headline').textContent;
    const description = document.getElementById('ai-description').textContent;
    const code = document.getElementById('ai-adl-code').textContent;
    
    const data = `AI Generated Ad Copy\n\nHeadline: ${headline}\nDescription: ${description}\nADL Code: ${code}\n\nGenerated: ${new Date().toISOString()}`;
    
    const blob = new Blob([data], { type: 'text/plain' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `ai_ad_copy_${Date.now()}.txt`;
    a.click();
    URL.revokeObjectURL(url);
    
    showNotification('📊 AI ad data exported!');
}

// FORM HANDLING
document.getElementById('campaign-form').addEventListener('submit', function(e) {
    e.preventDefault();
    
    // Check campaign limits when submitting, not when opening modal
    if (!canCreateCampaign()) {
        showNotification('⭐ Campaign limit reached. Upgrade for unlimited campaigns');
        showUpgrade();
        return;
    }
    
    const name = document.getElementById('name').value;
    const source = document.getElementById('source').value;
    const budget = parseInt(document.getElementById('budget').value);
    const url = document.getElementById('url').value;
    const code = document.getElementById('generated-code').textContent;
    
    const newCampaign = {
        id: Date.now(),
        name,
        source,
        budget,
        url,
        code,
        status: 'active',
        clicks: Math.floor(Math.random() * 50),
        conversions: Math.floor(Math.random() * 10),
        revenue: Math.random() * 500,
        impressions: Math.floor(Math.random() * 2000) + 1000,
        ctr: (Math.random() * 3 + 1).toFixed(2),
        cpc: (Math.random() * 2 + 0.5).toFixed(2),
        created: new Date().toISOString().split('T')[0]
    };
    
    campaigns.push(newCampaign);
    renderCampaigns();
    updateTotals();
    closeModal('create-modal');
    document.getElementById('campaign-form').reset();
    document.getElementById('adl-preview').style.display = 'none';
    showNotification('🎉 Campaign created!');
});

// AI Form Handling
document.getElementById('ai-ad-form').addEventListener('submit', function(e) {
    e.preventDefault();
    
    if (!canUseAI()) {
        showNotification('⭐ AI usage limit reached. Upgrade for unlimited access');
        showUpgrade();
        return;
    }
    
    const product = document.getElementById('ai-product').value;
    const keywords = document.getElementById('ai-keywords').value;
    const audience = document.getElementById('ai-audience').value;
    const platform = document.getElementById('ai-platform').value;
    const offer = document.getElementById('ai-offer').value || 'Special Offer';
    
    // Increment AI usage
    aiUsageCount++;
    updateTierDisplay();
    
    // Generate AI content
    const templates = aiAdTemplates[platform] || aiAdTemplates.universal;
    const headlineTemplate = templates.headlines[Math.floor(Math.random() * templates.headlines.length)];
    const descriptionTemplate = templates.descriptions[Math.floor(Math.random() * templates.descriptions.length)];
    
    const headline = headlineTemplate
        .replace(/{product}/g, product)
        .replace(/{keywords}/g, keywords)
        .replace(/{audience}/g, audience)
        .replace(/{offer}/g, offer);
    
    const description = descriptionTemplate
        .replace(/{product}/g, product)
        .replace(/{keywords}/g, keywords)
        .replace(/{audience}/g, audience)
        .replace(/{offer}/g, offer);
    
    const adlCode = generateADLCode(platform);
    
    // Display results
    document.getElementById('ai-headline').textContent = headline;
    document.getElementById('ai-description').textContent = description;
    document.getElementById('ai-adl-code').textContent = adlCode;
    document.getElementById('ai-seo-keywords').textContent = keywords + ', ' + product + ', ' + audience;
    
    document.getElementById('ai-results').style.display = 'block';
    
    showNotification('🤖 AI ad copy generated successfully!');
});

// ADL CODE GENERATION ON SOURCE CHANGE
document.getElementById('source').addEventListener('change', function() {
    const source = this.value;
    if (source) {
        const code = generateADLCode(source);
        document.getElementById('generated-code').textContent = code;
        document.getElementById('adl-preview').style.display = 'block';
        
        // Show campaign limit warning in free tier
        if (userTier === 'free') {
            const warningElement = document.getElementById('campaign-limit-warning');
            const countElement = document.getElementById('current-campaign-count');
            if (warningElement && countElement) {
                countElement.textContent = campaigns.length;
                warningElement.style.display = campaigns.length >= 2 ? 'block' : 'none';
            }
        }
    } else {
        document.getElementById('adl-preview').style.display = 'none';
        document.getElementById('campaign-limit-warning').style.display = 'none';
    }
});

// INITIALIZE APP
document.addEventListener('DOMContentLoaded', function() {
    // Initialize core app first
    renderCampaigns();
    updateTotals();
    updateTierDisplay();
    
    // Add Instructions button event listener - FULL PAGE VERSION
    const instructionsBtn = document.getElementById('instructions-btn');
    if (instructionsBtn) {
        instructionsBtn.addEventListener('click', function() {
            // Hide main content
            document.querySelector('main').style.display = 'none';
            
            // Create full-page instructions
            const instructionsPage = document.createElement('div');
            instructionsPage.id = 'instructions-page';
            instructionsPage.innerHTML = `
                <div class="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 py-8">
                    <div class="max-w-4xl mx-auto px-4">
                        <div class="flex items-center justify-between mb-8">
                            <h1 class="text-4xl font-bold text-gray-900">📚 ADL Platform Instructions</h1>
                            <button onclick="closeInstructionsPage()" class="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium">
                                ← Back to Dashboard
                            </button>
                        </div>
                        
                        <div class="space-y-8">
                            <!-- Section 1 -->
                            <div class="bg-blue-50 p-8 rounded-xl border border-blue-200 shadow-lg">
                                <h2 class="text-2xl font-bold text-blue-800 mb-6">🚀 1. Create Campaign</h2>
                                <ul class="text-blue-700 space-y-3 text-lg leading-relaxed">
                                    <li>• Click "Create Campaign" to start a new ad tracking campaign</li>
                                    <li>• Choose your advertising platform (Google, Facebook, TikTok, etc.)</li>
                                    <li>• Set your budget and target URL</li>
                                    <li>• ADL automatically generates a unique tracking code (ADL_XX####)</li>
                                    <li>• This code tracks across ALL platforms without expensive tools</li>
                                </ul>
                            </div>
                            
                            <!-- Section 2 -->
                            <div class="bg-purple-50 p-8 rounded-xl border border-purple-200 shadow-lg">
                                <h2 class="text-2xl font-bold text-purple-800 mb-6">🤖 2. AI Ad Generator</h2>
                                <ul class="text-purple-700 space-y-3 text-lg leading-relaxed">
                                    <li>• Click "AI Ad Generator" for SEO-optimized ad copy</li>
                                    <li>• Enter your product, keywords, and target audience</li>
                                    <li>• AI creates high-converting headlines and descriptions</li>
                                    <li>• Includes your ADL tracking code automatically</li>
                                    <li>• Optimized for ranking on search engines and social platforms</li>
                                </ul>
                            </div>
                            
                            <!-- Section 3 -->
                            <div class="bg-green-50 p-8 rounded-xl border border-green-200 shadow-lg">
                                <h2 class="text-2xl font-bold text-green-800 mb-6">📊 3. Automatic Analytics & Tracking</h2>
                                <ul class="text-green-700 space-y-3 text-lg leading-relaxed">
                                    <li>• Click "View Analytics" on any campaign for detailed metrics</li>
                                    <li>• See real-time clicks, conversions, revenue, and ROI automatically</li>
                                    <li>• ADL tracking codes are auto-embedded in all generated ads</li>
                                    <li>• Works across Google, Facebook, TikTok, LinkedIn, and 20+ platforms</li>
                                    <li>• No need for expensive Google Analytics or GTM setup</li>
                                </ul>
                            </div>
                            
                            <!-- Section 4 -->
                            <div class="bg-yellow-50 p-8 rounded-xl border border-yellow-200 shadow-lg">
                                <h2 class="text-2xl font-bold text-yellow-800 mb-6">🔗 4. Auto-Embedded ADL Tracking</h2>
                                <ul class="text-yellow-700 space-y-3 text-lg leading-relaxed">
                                    <li>• ADL automatically embeds unique tracking codes in your ads (e.g., ADL_GO4XY1Z2345)</li>
                                    <li>• No manual code insertion needed - everything happens automatically</li>
                                    <li>• Your ads are instantly trackable across ALL platforms when published</li>
                                    <li>• AI-generated ads include tracking codes automatically</li>
                                    <li>• See which ads bring the most conversions and revenue without any setup</li>
                                </ul>
                            </div>
                            
                            <!-- Section 5 -->
                            <div class="bg-red-50 p-8 rounded-xl border border-red-200 shadow-lg">
                                <h2 class="text-2xl font-bold text-red-800 mb-6">💡 5. Key Benefits</h2>
                                <ul class="text-red-700 space-y-3 text-lg leading-relaxed">
                                    <li>• ✅ Replace expensive Google Ads tracking and GTM</li>
                                    <li>• ✅ Universal tracking across 25+ advertising platforms</li>
                                    <li>• ✅ AI-generated SEO-optimized ad copy for better rankings</li>
                                    <li>• ✅ Real-time analytics without monthly subscription fees</li>
                                    <li>• ✅ One tracking code works everywhere</li>
                                </ul>
                            </div>
                        </div>
                        
                        <div class="text-center mt-12">
                            <button onclick="closeInstructionsPage()" class="px-8 py-4 bg-blue-600 text-white rounded-xl hover:bg-blue-700 font-bold text-lg shadow-lg">
                                Ready to Start! → Go to Dashboard
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            // Add to page
            document.body.appendChild(instructionsPage);
        });
        console.log('Instructions button event listener added successfully');
    } else {
        console.error('Instructions button not found!');
    }
    
    // Simple ad rotation - back to working method
    setTimeout(() => {
        rotateSoftAds(); // First rotation
        setInterval(rotateSoftAds, 6000); // Then every 6 seconds
    }, 1000); // Short delay
    
    // Auto-refresh every 30 seconds
    setInterval(() => {
        campaigns = campaigns.map(c => {
            if (c.status === 'active') {
                return {
                    ...c,
                    clicks: c.clicks + Math.floor(Math.random() * 5),
                    conversions: c.conversions + Math.floor(Math.random() * 2),
                    revenue: c.revenue + Math.random() * 50
                };
            }
            return c;
        });
        renderCampaigns();
        updateTotals();
    }, 30000);
    
    // Keyboard shortcuts
    document.addEventListener('keydown', function(e) {
        if (e.ctrlKey || e.metaKey) {
            switch(e.key) {
                case 'n':
                    e.preventDefault();
                    createCampaign();
                    break;
                case 'e':
                    e.preventDefault();
                    exportAllData();
                    break;
                case 'a':
                    e.preventDefault();
                    showAnalyticsDashboard();
                    break;
            }
        }
    });
});
</script>

</body>
</html>
