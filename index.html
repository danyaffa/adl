<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ADL Platform - Universal Ad Tracking & Analytics</title>
    <meta name="description" content="Professional ad tracking platform with real payment processing, fraud protection, and universal analytics across 25+ platforms">
    <meta name="keywords" content="ad tracking, analytics, universal tracking, campaign management, ROI tracking, fraud protection">
    <meta name="author" content="D & J LEFFLER">
    
    <!-- Security Headers -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' https:; script-src 'self' 'unsafe-inline' https:; style-src 'self' 'unsafe-inline' https:;">
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>‚ö°</text></svg>">
    
    <!-- Stripe Payment Processing -->
    <script src="https://js.stripe.com/v3/"></script>
    
    <!-- Core CSS Framework -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        * { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; 
            box-sizing: border-box;
        }
        
        body {
            margin: 0;
            padding: 0;
            padding-bottom: 120px;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            line-height: 1.6;
        }
        
        .modal { 
            display: none; 
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            z-index: 1000;
            backdrop-filter: blur(4px);
        }
        
        .modal.show { 
            display: flex !important; 
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .secure-payment {
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            box-shadow: 0 20px 40px rgba(59, 130, 246, 0.3);
        }
        
        .payment-input {
            background: rgba(255, 255, 255, 0.95);
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: #1f2937;
            padding: 16px 20px;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        .payment-input:focus {
            outline: none;
            border-color: #10b981;
            background: rgba(255, 255, 255, 1);
            box-shadow: 0 0 20px rgba(16, 185, 129, 0.2);
        }
        
        .ssl-badge {
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid rgba(16, 185, 129, 0.3);
            border-radius: 8px;
            padding: 12px 16px;
            color: #10b981;
            font-weight: 600;
        }
        
        .pricing-card {
            background: white;
            border-radius: 20px;
            padding: 2rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            transition: all 0.4s ease;
            position: relative;
            overflow: hidden;
        }
        
        .pricing-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.15);
        }
        
        .pricing-card.popular::before {
            content: 'MOST POPULAR';
            position: absolute;
            top: 20px;
            right: -30px;
            background: #f59e0b;
            color: white;
            padding: 8px 40px;
            font-size: 12px;
            font-weight: bold;
            transform: rotate(45deg);
        }
        
        .campaign-card {
            background: white;
            border-radius: 16px;
            padding: 1.5rem;
            border: 1px solid #e5e7eb;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .campaign-card:hover {
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            transform: translateY(-2px);
        }
        
        .status-active {
            background: linear-gradient(45deg, #10b981, #059669);
            color: white;
        }
        
        .status-paused {
            background: linear-gradient(45deg, #6b7280, #4b5563);
            color: white;
        }
        
        .adl-code {
            font-family: 'SF Mono', Monaco, monospace;
            background: #f8fafc;
            border: 2px solid #e2e8f0;
            padding: 12px 16px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            color: #1e293b;
            word-break: break-all;
        }
        
        .fraud-protection {
            background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);
            color: white;
            padding: 1rem;
            border-radius: 12px;
            margin: 1rem 0;
            border: 2px solid rgba(255, 255, 255, 0.2);
        }
        
        .prohibited-content {
            background: #fef2f2;
            border: 1px solid #fecaca;
            border-radius: 8px;
            padding: 1rem;
            color: #dc2626;
            font-size: 14px;
        }
        
        .loading-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: inherit;
        }
        
        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid #e5e7eb;
            border-top: 3px solid #3b82f6;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .step-indicator {
            display: flex;
            justify-content: center;
            margin-bottom: 2rem;
        }

        .step {
            display: flex;
            align-items: center;
            margin: 0 1rem;
        }

        .step-number {
            width: 2rem;
            height: 2rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 0.5rem;
        }

        .step.active .step-number {
            background: #3b82f6;
            color: white;
        }

        .step.completed .step-number {
            background: #10b981;
            color: white;
        }

        .step:not(.active):not(.completed) .step-number {
            background: #e5e7eb;
            color: #6b7280;
        }
        
        @media (max-width: 768px) {
            .pricing-card {
                padding: 1.5rem;
            }
            
            .campaign-card {
                padding: 1rem;
            }
        }
    </style>
</head>
<body>

<!-- SECURE HEADER -->
<header class="bg-white border-b-2 border-blue-200 shadow-lg sticky top-0 z-40">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 py-4">
        <div class="flex items-center justify-between">
            <div class="flex items-center space-x-4">
                <img src="public/ADL_logo.png" alt="ADL Platform" class="w-16 h-16" onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                <div class="text-4xl" style="display: none;">‚ö°</div>
                <div>
                    <h1 class="text-2xl font-bold text-gray-900">ADL Platform</h1>
                    <p class="text-sm text-gray-600">Universal Ad Tracking & Analytics</p>
                </div>
            </div>
            
            <div class="flex items-center space-x-4">
                <div id="user-tier" class="px-4 py-2 bg-blue-600 text-white rounded-full text-sm font-bold">
                    STARTER PLAN
                </div>
                <div class="text-sm text-gray-600" id="plan-limits">
                    Campaigns: <span id="campaign-count">0</span>/5
                </div>
                <div id="user-status" class="text-sm text-gray-500" style="display: none;">
                    üë§ <span id="user-name"></span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- MAIN DASHBOARD -->
<main class="max-w-7xl mx-auto px-4 sm:px-6 py-8">
    
    <!-- QUICK ACTIONS -->
    <div class="grid grid-cols-2 md:grid-cols-6 gap-4 mb-8">
        <button onclick="createCampaign()" class="bg-blue-600 hover:bg-blue-700 text-white p-4 rounded-xl font-bold transition-all transform hover:scale-105">
            üöÄ Create Campaign
        </button>
        <button onclick="generateAIAd()" class="bg-purple-600 hover:bg-purple-700 text-white p-4 rounded-xl font-bold transition-all transform hover:scale-105">
            ü§ñ AI Generator
        </button>
        <button onclick="showInstructions()" class="bg-green-600 hover:bg-green-700 text-white p-4 rounded-xl font-bold transition-all transform hover:scale-105">
            üìö Instructions
        </button>
        <button onclick="showContact()" class="bg-cyan-600 hover:bg-cyan-700 text-white p-4 rounded-xl font-bold transition-all transform hover:scale-105">
            üìû Contact
        </button>
        <button onclick="showReview()" class="bg-yellow-600 hover:bg-yellow-700 text-white p-4 rounded-xl font-bold transition-all transform hover:scale-105">
            ‚≠ê Review
        </button>
        <button onclick="showUpgrade()" class="bg-gradient-to-r from-yellow-500 to-orange-500 hover:shadow-lg text-white p-4 rounded-xl font-bold transition-all transform hover:scale-105">
            ‚≠ê Upgrade Plan
        </button>
    </div>

    <!-- PERFORMANCE METRICS -->
    <div class="grid grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
        <div class="bg-white p-6 rounded-xl border-2 border-blue-100 hover:shadow-lg transition-shadow">
            <div class="flex items-center justify-between mb-3">
                <span class="text-sm font-bold text-blue-600">TOTAL CLICKS</span>
                <span class="text-2xl">üëÜ</span>
            </div>
            <div id="total-clicks" class="text-3xl font-bold text-gray-900">0</div>
            <div class="text-sm text-gray-500 mt-1">Real-time tracking active</div>
        </div>
        
        <div class="bg-white p-6 rounded-xl border-2 border-green-100 hover:shadow-lg transition-shadow">
            <div class="flex items-center justify-between mb-3">
                <span class="text-sm font-bold text-green-600">CONVERSIONS</span>
                <span class="text-2xl">üéØ</span>
            </div>
            <div id="total-conversions" class="text-3xl font-bold text-gray-900">0</div>
            <div class="text-sm text-gray-500 mt-1">Cross-platform attribution</div>
        </div>
        
        <div class="bg-white p-6 rounded-xl border-2 border-yellow-100 hover:shadow-lg transition-shadow">
            <div class="flex items-center justify-between mb-3">
                <span class="text-sm font-bold text-yellow-600">REVENUE</span>
                <span class="text-2xl">üí∞</span>
            </div>
            <div id="total-revenue" class="text-3xl font-bold text-gray-900">$0</div>
            <div class="text-sm text-gray-500 mt-1">Revenue attribution</div>
        </div>
        
        <div class="bg-white p-6 rounded-xl border-2 border-purple-100 hover:shadow-lg transition-shadow">
            <div class="flex items-center justify-between mb-3">
                <span class="text-sm font-bold text-purple-600">ROAS</span>
                <span class="text-2xl">üìà</span>
            </div>
            <div id="total-roas" class="text-3xl font-bold text-gray-900">0.0x</div>
            <div class="text-sm text-gray-500 mt-1">Return on ad spend</div>
        </div>
    </div>

    <!-- CAMPAIGNS SECTION -->
    <div class="bg-white rounded-xl p-6 border-2 border-gray-100">
        <div class="flex justify-between items-center mb-6">
            <div>
                <h2 class="text-2xl font-bold text-gray-900">Active Campaigns</h2>
                <p class="text-gray-600">Universal tracking across all platforms</p>
            </div>
            <button onclick="refreshData()" class="bg-gray-100 hover:bg-gray-200 px-4 py-2 rounded-lg transition-colors">
                üîÑ Refresh
            </button>
        </div>
        
        <div id="campaigns-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <!-- Empty state shown when no campaigns exist -->
            <div class="col-span-full text-center py-12">
                <div class="text-6xl mb-4">üöÄ</div>
                <h3 class="text-xl font-bold text-gray-800 mb-2">Ready to Launch Your First Campaign?</h3>
                <p class="text-gray-600 mb-6">Create your first campaign to start tracking across all platforms</p>
                <button onclick="createCampaign()" class="bg-blue-600 hover:bg-blue-700 text-white px-8 py-3 rounded-xl font-bold transition-colors">
                    üë§ Set Up Account<br>& Create First Campaign
                </button>
                <div class="mt-6 text-sm text-gray-500 space-y-1">
                    <p>‚úÖ Universal tracking across 25+ platforms</p>
                    <p>‚úÖ Real-time analytics and reporting</p>
                    <p>‚úÖ Automatic fraud protection</p>
                </div>
            </div>
        </div>
    </div>

</main>

<!-- COMBINED ACCOUNT SETUP & CAMPAIGN CREATION MODAL -->
<div id="create-modal" class="modal">
    <div class="bg-white rounded-2xl max-w-4xl w-full mx-4 p-8 max-h-[90vh] overflow-y-auto">
        
        <!-- Step Indicator -->
        <div class="step-indicator">
            <div class="step active" id="step-account">
                <div class="step-number">1</div>
                <span class="text-sm font-medium">Account Setup</span>
            </div>
            <div class="mx-4 text-gray-300">‚Üí</div>
            <div class="step" id="step-campaign">
                <div class="step-number">2</div>
                <span class="text-sm font-medium">Create Campaign</span>
            </div>
        </div>

        <div class="flex justify-between items-center mb-6">
            <h3 class="text-2xl font-bold text-gray-900" id="modal-title">üë§ Set Up Account & Create First Campaign</h3>
            <button onclick="closeModal('create-modal')" class="text-gray-400 hover:text-gray-600 text-2xl font-bold">√ó</button>
        </div>
        
        <!-- STEP 1: ACCOUNT SETUP -->
        <div id="account-step" class="space-y-6">
            <div class="bg-blue-50 p-6 rounded-xl border border-blue-200 mb-6">
                <div class="flex items-center space-x-3 mb-3">
                    <span class="text-2xl">üë§</span>
                    <h4 class="text-lg font-bold text-blue-800">Create Your ADL Account</h4>
                </div>
                <p class="text-blue-700">Set up your account to start tracking campaigns across all platforms with universal ADL codes.</p>
            </div>
            
            <form id="account-setup-form" class="space-y-6">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-sm font-bold text-gray-700 mb-2">First Name *</label>
                        <input type="text" id="first-name" required class="w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:border-blue-500 focus:outline-none" placeholder="John">
                    </div>
                    <div>
                        <label class="block text-sm font-bold text-gray-700 mb-2">Last Name *</label>
                        <input type="text" id="last-name" required class="w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:border-blue-500 focus:outline-none" placeholder="Smith">
                    </div>
                </div>
                
                <div>
                    <label class="block text-sm font-bold text-gray-700 mb-2">Email Address *</label>
                    <input type="email" id="account-email" required class="w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:border-blue-500 focus:outline-none" placeholder="john@example.com">
                </div>
                
                <div>
                    <label class="block text-sm font-bold text-gray-700 mb-2">Company Name (Optional)</label>
                    <input type="text" id="company-name" class="w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:border-blue-500 focus:outline-none" placeholder="My Business">
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-sm font-bold text-gray-700 mb-2">Password *</label>
                        <input type="password" id="account-password" required class="w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:border-blue-500 focus:outline-none" placeholder="Create secure password">
                    </div>
                    <div>
                        <label class="block text-sm font-bold text-gray-700 mb-2">Confirm Password *</label>
                        <input type="password" id="confirm-password" required class="w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:border-blue-500 focus:outline-none" placeholder="Confirm password">
                    </div>
                </div>
                
                <div>
                    <label class="block text-sm font-bold text-gray-700 mb-2">Country *</label>
                    <select id="account-country" required class="w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:border-blue-500 focus:outline-none">
                        <option value="">Select Country</option>
                        <option value="AU">Australia</option>
                        <option value="US">United States</option>
                        <option value="UK">United Kingdom</option>
                        <option value="CA">Canada</option>
                        <option value="NZ">New Zealand</option>
                        <option value="OTHER">Other</option>
                    </select>
                </div>
                
                <div class="flex items-center space-x-3">
                    <input type="checkbox" id="account-terms" class="w-5 h-5" required>
                    <label for="account-terms" class="text-sm font-medium text-gray-700">
                        I agree to the Terms of Service, Privacy Policy, and Content Guidelines
                    </label>
                </div>
                
                <button type="button" onclick="proceedToCampaignStep()" class="w-full bg-blue-600 hover:bg-blue-700 text-white py-4 rounded-xl font-bold text-lg transition-colors">
                    üìù Create Account & Continue to Campaign Setup
                </button>
            </form>
        </div>

        <!-- STEP 2: CAMPAIGN CREATION -->
        <div id="campaign-step" class="space-y-6" style="display: none;">
            <!-- Fraud Protection Notice -->
            <div class="fraud-protection mb-6">
                <div class="flex items-center space-x-3 mb-3">
                    <span class="text-2xl">üõ°Ô∏è</span>
                    <h4 class="font-bold">Automatic Fraud Protection Active</h4>
                </div>
                <p class="text-sm opacity-90">All campaigns are automatically screened for prohibited content. Violations result in immediate suspension.</p>
            </div>
            
            <form id="campaign-creation-form" class="space-y-6">
                <div>
                    <label class="block text-sm font-bold text-gray-700 mb-2">Campaign Name *</label>
                    <input type="text" id="campaign-name" required class="w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:border-blue-500 focus:outline-none" placeholder="Holiday Sale 2025">
                </div>
                
                <div>
                    <label class="block text-sm font-bold text-gray-700 mb-2">Advertising Platform *</label>
                    <select id="campaign-source" required class="w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:border-blue-500 focus:outline-none">
                        <option value="">Choose Platform</option>
                        <option value="Google Ads">Google Ads</option>
                        <option value="Facebook Ads">Facebook Ads</option>
                        <option value="TikTok Ads">TikTok Ads</option>
                        <option value="Instagram Ads">Instagram Ads</option>
                        <option value="LinkedIn Ads">LinkedIn Ads</option>
                        <option value="Twitter Ads">Twitter Ads</option>
                        <option value="YouTube Ads">YouTube Ads</option>
                        <option value="Amazon Ads">Amazon Ads</option>
                        <option value="Microsoft Ads">Microsoft Ads</option>
                        <option value="Snapchat Ads">Snapchat Ads</option>
                        <option value="Pinterest Ads">Pinterest Ads</option>
                        <option value="Reddit Ads">Reddit Ads</option>
                        <option value="Other">Other Platform</option>
                    </select>
                </div>
                
                <div>
                    <label class="block text-sm font-bold text-gray-700 mb-2">Monthly Budget ($) *</label>
                    <input type="number" id="campaign-budget" required min="1" class="w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:border-blue-500 focus:outline-none" placeholder="2500">
                </div>
                
                <div>
                    <label class="block text-sm font-bold text-gray-700 mb-2">Landing Page URL *</label>
                    <input type="url" id="campaign-url" required class="w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:border-blue-500 focus:outline-none" placeholder="https://mystore.com">
                </div>
                
                <div id="adl-code-preview" class="bg-blue-50 p-4 rounded-xl border-2 border-blue-200" style="display: none;">
                    <div class="flex justify-between items-center mb-3">
                        <span class="text-sm font-bold text-blue-800">üîó Auto-Generated ADL Code:</span>
                        <button type="button" onclick="copyCode()" class="bg-blue-600 text-white px-4 py-2 rounded-lg text-sm font-bold hover:bg-blue-700">
                            üìã Copy
                        </button>
                    </div>
                    <div id="generated-adl-code" class="adl-code"></div>
                </div>
                
                <div class="flex gap-4">
                    <button type="button" onclick="backToAccountStep()" class="flex-1 bg-gray-100 hover:bg-gray-200 text-gray-700 py-4 rounded-xl font-bold text-lg transition-colors">
                        ‚Üê Back to Account
                    </button>
                    <button type="submit" class="flex-1 bg-blue-600 hover:bg-blue-700 text-white py-4 rounded-xl font-bold text-lg transition-colors">
                        üöÄ Create Campaign & Account
                    </button>
                </div>
            </form>
        </div>
        
        <div class="text-center mt-6 text-sm text-gray-500">
            <p>üîí Your account data is encrypted and secure</p>
            <p>‚úÖ Australian business - supporting local entrepreneurs</p>
            <p class="text-xs mt-2 text-blue-600">
                üìù Demo Mode: Account data stored in session (production will use secure database)
            </p>
        </div>
    </div>
</div>

<!-- Fixed Ads Strip -->
<div id="ads-strip" class="fixed bottom-0 left-0 right-0 z-30 bg-white border-t-4 border-blue-500 shadow-2xl">
    <div class="max-w-7xl mx-auto px-6 py-4">
        <div class="flex items-center justify-between">
            <div class="flex items-center space-x-4">
                <div id="ad-logo" class="text-4xl animate-pulse">üé®</div>
                <div class="flex-1">
                    <p id="ad-text" class="text-lg text-gray-800 font-bold">Master digital marketing with Udemy courses - Up to 85% off</p>
                    <p class="text-sm text-gray-600">Limited time offer - Don't miss out!</p>
                </div>
            </div>
            <div class="flex items-center space-x-4">
                <button id="ad-cta" onclick="clickAd()" class="px-8 py-3 bg-blue-600 text-white rounded-xl text-lg font-bold hover:bg-blue-700 transition-colors shadow-lg hover:shadow-xl transform hover:scale-105">
                    Learn Now
                </button>
                <div class="text-gray-400 text-xs">
                    <span class="bg-gray-100 px-2 py-1 rounded-full">Ads support free ADL</span>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="notification" class="fixed top-6 right-6 z-50 bg-green-600 text-white px-6 py-4 rounded-xl shadow-lg font-bold transform translate-x-full transition-transform duration-300">
    <span id="notification-text"></span>
</div>

<script>
// CORE APPLICATION STATE
var userTier = 'starter';
var campaigns = [];
var aiUsageCount = 0;
var selectedPlan = null;
var selectedPrice = 0;
var currentAdIndex = 0;
var currentUser = null;
var currentStep = 1;

// SESSION MANAGEMENT (In-Memory)
var sessionData = {
    user: null,
    campaigns: [],
    settings: {}
};

// Simulate user login state
function updateSessionData() {
    if (currentUser) {
        sessionData.user = currentUser;
        sessionData.campaigns = campaigns;
        sessionData.settings = { tier: userTier, aiUsage: aiUsageCount };
        console.log('Session updated:', sessionData);
    }
}

// TIER LIMITS
var TIER_LIMITS = {
    starter: { campaigns: 5, ai: 10 },
    pro: { campaigns: Infinity, ai: Infinity },
    enterprise: { campaigns: Infinity, ai: Infinity }
};

// ADS CONFIGURATION
var softAds = [
    {
        logo: 'üé®',
        text: 'Master digital marketing with Udemy courses - Up to 85% off',
        cta: 'Learn Now',
        url: 'https://www.udemy.com/',
        color: 'blue'
    },
    {
        logo: 'üõçÔ∏è',
        text: 'Build your store with Shopify - 14-day free trial',
        cta: 'Start Free',
        url: 'https://www.shopify.com/',
        color: 'green'
    },
    {
        logo: 'üìö',
        text: 'Design stunning ads with Canva Pro - 50% off first month',
        cta: 'Try Canva',
        url: 'https://www.canva.com/pro/',
        color: 'purple'
    },
    {
        logo: 'üìä',
        text: 'Optimize campaigns with Buffer Pro - 30% discount',
        cta: 'Get Buffer',
        url: 'https://buffer.com/',
        color: 'indigo'
    }
];

// PROHIBITED CONTENT DETECTION
var PROHIBITED_TERMS = [
    'illegal drugs', 'weapons sales', 'counterfeit goods',
    'money laundering', 'pyramid scheme', 'ponzi scheme',
    'adult services', 'escort services', 'sexual content',
    'get rich quick', 'guaranteed income', 'miracle cure',
    'lose weight fast', 'secret government',
    'cryptocurrency investment', 'forex trading signals',
    'medical advice', 'legal advice', 'tax advice'
];

// UTILITY FUNCTIONS
function generateADLCode(source) {
    var prefix = 'ADL_';
    var sourceCode = source.substring(0, 2).toUpperCase();
    var random = Math.random().toString(36).substring(2, 6).toUpperCase();
    var timestamp = Date.now().toString().slice(-4);
    return prefix + sourceCode + random + timestamp;
}

function showNotification(message, type) {
    if (!type) type = 'success';
    var notification = document.getElementById('notification');
    var text = document.getElementById('notification-text');
    
    notification.className = 'fixed top-6 right-6 z-50 px-6 py-4 rounded-xl shadow-lg font-bold transition-transform duration-300 ' + 
        (type === 'error' ? 'bg-red-600' : 'bg-green-600') + ' text-white';
    
    text.textContent = message;
    notification.style.transform = 'translateX(0)';
    
    setTimeout(function() {
        notification.style.transform = 'translateX(100%)';
    }, 4000);
}

function openModal(modalId) {
    var modal = document.getElementById(modalId);
    if (modal) {
        modal.classList.add('show');
        document.body.style.overflow = 'hidden';
    }
}

function closeModal(modalId) {
    var modal = document.getElementById(modalId);
    if (modal) {
        modal.classList.remove('show');
        document.body.style.overflow = 'auto';
        
        if (modalId === 'create-modal') {
            resetCreateModal();
        }
    }
}

function copyToClipboard(text) {
    if (navigator.clipboard) {
        navigator.clipboard.writeText(text).then(function() {
            showNotification('üìã Copied to clipboard!');
        });
    } else {
        showNotification('üìã Copy manually: ' + text);
    }
}

// STEP MANAGEMENT FUNCTIONS
function updateStepIndicator(step) {
    var stepAccount = document.getElementById('step-account');
    var stepCampaign = document.getElementById('step-campaign');
    
    stepAccount.classList.remove('active', 'completed');
    stepCampaign.classList.remove('active', 'completed');
    
    if (step === 1) {
        stepAccount.classList.add('active');
        document.getElementById('modal-title').textContent = 'üë§ Set Up Account & Create First Campaign';
    } else if (step === 2) {
        stepAccount.classList.add('completed');
        stepCampaign.classList.add('active');
        document.getElementById('modal-title').textContent = 'üöÄ Create Your First Campaign';
    }
}

function proceedToCampaignStep() {
    var firstName = document.getElementById('first-name').value;
    var lastName = document.getElementById('last-name').value;
    var email = document.getElementById('account-email').value;
    var password = document.getElementById('account-password').value;
    var confirmPassword = document.getElementById('confirm-password').value;
    var country = document.getElementById('account-country').value;
    var termsAccepted = document.getElementById('account-terms').checked;
    
    if (!firstName || !lastName || !email || !password || !confirmPassword || !country) {
        showNotification('‚ö†Ô∏è Please fill in all required fields', 'error');
        return;
    }
    
    if (!termsAccepted) {
        showNotification('‚ö†Ô∏è Please accept the terms and conditions', 'error');
        return;
    }
    
    if (password !== confirmPassword) {
        showNotification('‚ö†Ô∏è Passwords do not match', 'error');
        return;
    }
    
    if (password.length < 8) {
        showNotification('‚ö†Ô∏è Password must be at least 8 characters', 'error');
        return;
    }
    
    currentUser = {
        id: Date.now(),
        firstName: firstName,
        lastName: lastName,
        email: email,
        company: document.getElementById('company-name').value,
        country: country,
        plan: 'starter',
        created: new Date().toISOString(),
        campaigns: [],
        aiUsage: 0
    };
    
    updateSessionData();
    
    currentStep = 2;
    updateStepIndicator(2);
    
    document.getElementById('account-step').style.display = 'none';
    document.getElementById('campaign-step').style.display = 'block';
    
    showNotification('‚úÖ Account created! Now create your first campaign.');
}

function backToAccountStep() {
    currentStep = 1;
    updateStepIndicator(1);
    
    document.getElementById('account-step').style.display = 'block';
    document.getElementById('campaign-step').style.display = 'none';
}

function resetCreateModal() {
    currentStep = 1;
    updateStepIndicator(1);
    
    document.getElementById('account-step').style.display = 'block';
    document.getElementById('campaign-step').style.display = 'none';
    
    document.getElementById('account-setup-form').reset();
    document.getElementById('campaign-creation-form').reset();
    document.getElementById('adl-code-preview').style.display = 'none';
}

// ADS MANAGEMENT
function rotateSoftAds() {
    var ad = softAds[currentAdIndex];
    document.getElementById('ad-logo').textContent = ad.logo;
    document.getElementById('ad-text').textContent = ad.text;
    document.getElementById('ad-cta').textContent = ad.cta;
    
    currentAdIndex = (currentAdIndex + 1) % softAds.length;
}

function clickAd() {
    var currentAd = softAds[currentAdIndex === 0 ? softAds.length - 1 : currentAdIndex - 1];
    showNotification('üéØ Redirecting to partner website...');
    window.open(currentAd.url, '_blank');
}

function showInstructions() {
    showNotification('üìö Instructions feature coming soon!');
}

function showContact() {
    showNotification('üìû Contact feature coming soon!');
}

function showReview() {
    showNotification('‚≠ê Review feature coming soon!');
}

function screenContent(content) {
    var lowerContent = content.toLowerCase();
    
    for (var i = 0; i < PROHIBITED_TERMS.length; i++) {
        var term = PROHIBITED_TERMS[i];
        if (lowerContent.includes(term)) {
            return {
                approved: false,
                reason: 'Content containing "' + term + '" violates our content policy'
            };
        }
    }
    
    return { approved: true };
}

// CAMPAIGN MANAGEMENT
function createCampaign() {
    if (campaigns.length >= TIER_LIMITS[userTier].campaigns) {
        showNotification('‚≠ê Campaign limit reached. Upgrade for more campaigns', 'error');
        showUpgrade();
        return;
    }
    
    resetCreateModal();
    openModal('create-modal');
}

function renderCampaigns() {
    var grid = document.getElementById('campaigns-grid');
    if (!grid) return;
    
    if (campaigns.length === 0) {
        grid.innerHTML = '<div class="col-span-full text-center py-12">' +
            '<div class="text-6xl mb-4">üöÄ</div>' +
            '<h3 class="text-xl font-bold text-gray-800 mb-2">Ready to Launch Your First Campaign?</h3>' +
            '<p class="text-gray-600 mb-6">Create your first campaign to start tracking across all platforms</p>' +
            '<button onclick="createCampaign()" class="bg-blue-600 hover:bg-blue-700 text-white px-8 py-3 rounded-xl font-bold transition-colors">' +
            'üë§ Set Up Account<br>& Create First Campaign</button>' +
            '<div class="mt-6 text-sm text-gray-500 space-y-1">' +
            '<p>‚úÖ Universal tracking across 25+ platforms</p>' +
            '<p>‚úÖ Real-time analytics and reporting</p>' +
            '<p>‚úÖ Automatic fraud protection</p></div></div>';
        return;
    }
    
    var html = '';
    for (var i = 0; i < campaigns.length; i++) {
        var campaign = campaigns[i];
        var statusClass = campaign.status === 'active' ? 'status-active' : 'status-paused';
        var statusText = campaign.status === 'active' ? 'üü¢ Active' : '‚è∏Ô∏è Paused';
        var roas = campaign.budget > 0 ? (campaign.revenue / campaign.budget).toFixed(2) : '0.00';
        
        html += '<div class="campaign-card">' +
            '<div class="flex justify-between items-start mb-4">' +
            '<div class="flex-1">' +
            '<h3 class="text-lg font-bold text-gray-900 mb-1">' + campaign.name + '</h3>' +
            '<p class="text-gray-600 text-sm">' + campaign.source + '</p></div>' +
            '<span class="px-3 py-1 text-xs font-bold rounded-full ' + statusClass + '">' + statusText + '</span></div>' +
            '<div class="mb-4"><div class="flex justify-between items-center mb-2">' +
            '<span class="text-xs text-gray-500 font-medium">ADL Tracking Code:</span>' +
            '<button onclick="copyToClipboard(\'' + campaign.code + '\')" class="text-blue-600 text-xs hover:text-blue-800 font-medium">üìã Copy</button></div>' +
            '<div class="adl-code text-xs">' + campaign.code + '</div></div>' +
            '<div class="grid grid-cols-3 gap-3 mb-4">' +
            '<div class="text-center p-3 bg-blue-50 rounded-lg"><div class="text-xs text-blue-600 font-bold mb-1">CLICKS</div>' +
            '<div class="text-lg font-bold text-blue-700">' + (campaign.clicks || 0) + '</div></div>' +
            '<div class="text-center p-3 bg-green-50 rounded-lg"><div class="text-xs text-green-600 font-bold mb-1">CONVERSIONS</div>' +
            '<div class="text-lg font-bold text-green-700">' + (campaign.conversions || 0) + '</div></div>' +
            '<div class="text-center p-3 bg-yellow-50 rounded-lg"><div class="text-xs text-yellow-600 font-bold mb-1">ROAS</div>' +
            '<div class="text-lg font-bold text-yellow-700">' + roas + 'x</div></div></div>' +
            '<div class="flex gap-2">' +
            '<button onclick="viewAnalytics(' + campaign.id + ')" class="flex-1 bg-blue-600 text-white py-2 px-3 rounded-lg text-sm font-bold hover:bg-blue-700">üìä Analytics</button>' +
            '<button onclick="toggleCampaign(' + campaign.id + ')" class="bg-gray-100 text-gray-700 py-2 px-3 rounded-lg text-sm hover:bg-gray-200">' +
            (campaign.status === 'active' ? '‚è∏Ô∏è' : '‚ñ∂Ô∏è') + '</button>' +
            '<button onclick="deleteCampaign(' + campaign.id + ')" class="bg-red-100 text-red-700 py-2 px-3 rounded-lg text-sm hover:bg-red-200">üóëÔ∏è</button></div></div>';
    }
    
    grid.innerHTML = html;
}

function updateTotals() {
    var totalClicks = 0;
    var totalConversions = 0;
    var totalRevenue = 0;
    var totalBudget = 0;
    
    for (var i = 0; i < campaigns.length; i++) {
        var c = campaigns[i];
        totalClicks += (c.clicks || 0);
        totalConversions += (c.conversions || 0);
        totalRevenue += (c.revenue || 0);
        totalBudget += c.budget;
    }
    
    var totalRoas = totalBudget > 0 ? (totalRevenue / totalBudget).toFixed(1) : '0.0';
    
    document.getElementById('total-clicks').textContent = totalClicks.toLocaleString();
    document.getElementById('total-conversions').textContent = totalConversions.toLocaleString();
    document.getElementById('total-revenue').textContent = '$' + Math.round(totalRevenue).toLocaleString();
    document.getElementById('total-roas').textContent = totalRoas + 'x';
}

function updateTierDisplay() {
    var userTierEl = document.getElementById('user-tier');
    var campaignCountEl = document.getElementById('campaign-count');
    var userStatusEl = document.getElementById('user-status');
    var userNameEl = document.getElementById('user-name');
    
    var tierNames = {
        starter: 'STARTER PLAN',
        pro: 'PRO PLAN',
        enterprise: 'ENTERPRISE PLAN'
    };
    
    var tierColors = {
        starter: 'bg-green-600',
        pro: 'bg-blue-600',
        enterprise: 'bg-gradient-to-r from-purple-600 to-blue-600'
    };
    
    userTierEl.textContent = tierNames[userTier];
    userTierEl.className = 'px-4 py-2 text-white rounded-full text-sm font-bold ' + tierColors[userTier];
    campaignCountEl.textContent = campaigns.length;
    
    if (currentUser) {
        userStatusEl.style.display = 'block';
        userNameEl.textContent = currentUser.firstName + ' ' + currentUser.lastName;
    } else {
        userStatusEl.style.display = 'none';
    }
}

function toggleCampaign(id) {
    for (var i = 0; i < campaigns.length; i++) {
        if (campaigns[i].id === id) {
            campaigns[i].status = campaigns[i].status === 'active' ? 'paused' : 'active';
            renderCampaigns();
            showNotification('Campaign ' + (campaigns[i].status === 'active' ? 'resumed' : 'paused') + '!');
            break;
        }
    }
}

function deleteCampaign(id) {
    if (confirm('Are you sure you want to delete this campaign?')) {
        campaigns = campaigns.filter(function(c) { return c.id !== id; });
        renderCampaigns();
        updateTotals();
        showNotification('üóëÔ∏è Campaign deleted successfully');
    }
}

function viewAnalytics(id) {
    showNotification('üìä Advanced analytics available in your plan');
}

function generateAIAd() {
    if (aiUsageCount >= TIER_LIMITS[userTier].ai) {
        showNotification('‚≠ê AI usage limit reached. Upgrade for unlimited access', 'error');
        showUpgrade();
        return;
    }
    
    showNotification('ü§ñ AI Ad Generator coming soon!');
}

function refreshData() {
    showNotification('üîÑ Data refreshed from servers');
    renderCampaigns();
    updateTotals();
}

function showUpgrade() {
    showNotification('‚≠ê Upgrade feature coming soon!');
}

function copyCode() {
    var code = document.getElementById('generated-adl-code').textContent;
    copyToClipboard(code);
}

// EVENT LISTENERS
document.addEventListener('DOMContentLoaded', function() {
    renderCampaigns();
    updateTotals();
    updateTierDisplay();
    
    rotateSoftAds();
    setInterval(rotateSoftAds, 8000);
    
    var campaignForm = document.getElementById('campaign-creation-form');
    campaignForm.addEventListener('submit', function(e) {
        e.preventDefault();
        
        var name = document.getElementById('campaign-name').value;
        var source = document.getElementById('campaign-source').value;
        var budget = parseInt(document.getElementById('campaign-budget').value);
        var url = document.getElementById('campaign-url').value;
        
        var screening = screenContent(name + ' ' + url);
        if (!screening.approved) {
            showNotification('üö´ ' + screening.reason, 'error');
            return;
        }
        
        var newCampaign = {
            id: Date.now(),
            name: name,
            source: source,
            budget: budget,
            url: url,
            code: generateADLCode(source),
            status: 'active',
            clicks: 0,
            conversions: 0,
            revenue: 0,
            created: new Date().toISOString(),
            userId: currentUser ? currentUser.id : null
        };
        
        campaigns.push(newCampaign);
        
        if (currentUser) {
            currentUser.campaigns.push(newCampaign.id);
            updateSessionData();
        }
        
        renderCampaigns();
        updateTotals();
        updateTierDisplay();
        closeModal('create-modal');
        
        showNotification('üéâ Account created and first campaign launched! Tracking is now active.');
    });
    
    document.getElementById('campaign-source').addEventListener('change', function() {
        var source = this.value;
        if (source) {
            var code = generateADLCode(source);
            document.getElementById('generated-adl-code').textContent = code;
            document.getElementById('adl-code-preview').style.display = 'block';
        } else {
            document.getElementById('adl-code-preview').style.display = 'none';
        }
    });
    
    document.addEventListener('click', function(e) {
        if (e.target.classList.contains('modal')) {
            e.target.classList.remove('show');
            document.body.style.overflow = 'auto';
        }
    });
    
    document.addEventListener('keydown', function(e) {
        if (e.ctrlKey || e.metaKey) {
            switch(e.key) {
                case 'n':
                    e.preventDefault();
                    createCampaign();
                    break;
                case 'u':
                    e.preventDefault();
                    showUpgrade();
                    break;
            }
        }
        
        if (e.key === 'Escape') {
            var modals = document.querySelectorAll('.modal.show');
            for (var i = 0; i < modals.length; i++) {
                modals[i].classList.remove('show');
                document.body.style.overflow = 'auto';
            }
        }
    });
});
</script>

</body>
</html>
