<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ADL - Ad Data Logic Universal Tracking</title>
    
    <!-- PWA Meta Tags -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#1e40af">
    <link rel="manifest" href="/manifest.json">
    
    <!-- React & Dependencies -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone@7/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <style>
        /* Mobile-optimized styles */
        body {
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            overscroll-behavior: none;
        }
        
        /* Prevent iOS bounce */
        html, body {
            position: fixed;
            overflow: hidden;
            width: 100%;
            height: 100%;
        }
        
        #root {
            height: 100%;
            overflow: auto;
            -webkit-overflow-scrolling: touch;
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 3px;
        }
        
        /* Loading animation */
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .animate-pulse-slow {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
    </style>
</head>
<body class="bg-gray-50">
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect, useRef, useCallback } = React;
        
        // Icons
        const icons = {
            Plus: lucide.Plus,
            Copy: lucide.Copy,
            Download: lucide.Download,
            Eye: lucide.Eye,
            Edit: lucide.Edit3,
            Pause: lucide.Pause,
            Play: lucide.Play,
            Trash: lucide.Trash2,
            RefreshCw: lucide.RefreshCw,
            Settings: lucide.Settings,
            Smartphone: lucide.Smartphone,
            Wand: lucide.Wand2,
            TrendingUp: lucide.TrendingUp,
            MousePointer: lucide.MousePointer,
            Target: lucide.Target,
            DollarSign: lucide.DollarSign,
            BarChart: lucide.BarChart3,
            X: lucide.X,
            Check: lucide.Check,
            ChevronRight: lucide.ChevronRight,
            Globe: lucide.Globe,
            Zap: lucide.Zap,
            Shield: lucide.Shield,
            Menu: lucide.Menu,
            Home: lucide.Home,
            PlusCircle: lucide.PlusCircle,
            Activity: lucide.Activity,
            User: lucide.User
        };
        
        // API Configuration
        const API_BASE = 'https://api.addatalogic.com';
        
        // ADL Code Generator
        const generateADLCode = (source) => {
            const prefix = 'ADL_';
            const sourceCode = source ? source.substring(0, 2).toUpperCase() : 'XX';
            const random = Math.random().toString(36).substring(2, 8).toUpperCase();
            return `${prefix}${sourceCode}${random}`;
        };
        
        // Platform options
        const platforms = [
            'Google Ads', 'Facebook Ads', 'TikTok Ads', 'Instagram Ads', 
            'LinkedIn Ads', 'Twitter Ads', 'Pinterest Ads', 'Snapchat Ads',
            'YouTube Ads', 'Amazon Ads', 'Microsoft Ads', 'Reddit Ads',
            'Spotify Ads', 'Taboola', 'Outbrain', 'Native Ads', 'Display Ads',
            'Email Marketing', 'SMS Marketing', 'Affiliate', 'Influencer',
            'Direct Mail', 'TV Ads', 'Radio Ads', 'Other'
        ];
        
        // Main App Component
        const ADLApp = () => {
            const [campaigns, setCampaigns] = useState([]);
            const [showCreateModal, setShowCreateModal] = useState(false);
            const [showAnalyticsModal, setShowAnalyticsModal] = useState(false);
            const [selectedCampaign, setSelectedCampaign] = useState(null);
            const [showSettings, setShowSettings] = useState(false);
            const [activeTab, setActiveTab] = useState('dashboard');
            const [isLoading, setIsLoading] = useState(false);
            const [notification, setNotification] = useState(null);
            
            // Load campaigns on mount
            useEffect(() => {
                loadCampaigns();
                // Simulate real-time updates
                const interval = setInterval(updateMetrics, 5000);
                return () => clearInterval(interval);
            }, []);
            
            // Load campaigns from localStorage (simulating API)
            const loadCampaigns = () => {
                const stored = localStorage.getItem('adl_campaigns');
                if (stored) {
                    setCampaigns(JSON.parse(stored));
                }
            };
            
            // Save campaigns to localStorage
            const saveCampaigns = (updatedCampaigns) => {
                localStorage.setItem('adl_campaigns', JSON.stringify(updatedCampaigns));
                setCampaigns(updatedCampaigns);
            };
            
            // Update metrics (simulate real-time data)
            const updateMetrics = () => {
                setCampaigns(prev => prev.map(campaign => ({
                    ...campaign,
                    clicks: campaign.clicks + Math.floor(Math.random() * 5),
                    conversions: campaign.conversions + Math.floor(Math.random() * 2),
                    revenue: campaign.revenue + (Math.random() * 50)
                })));
            };
            
            // Show notification
            const showNotification = (message, type = 'success') => {
                setNotification({ message, type });
                setTimeout(() => setNotification(null), 3000);
            };
            
            // Create Campaign Modal
            const CreateCampaignModal = () => {
                const [formData, setFormData] = useState({
                    name: '',
                    source: '',
                    budget: '',
                    targetUrl: ''
                });
                const [adlCode, setAdlCode] = useState('');
                
                useEffect(() => {
                    if (formData.source) {
                        setAdlCode(generateADLCode(formData.source));
                    }
                }, [formData.source]);
                
                const handleSubmit = (e) => {
                    e.preventDefault();
                    
                    const newCampaign = {
                        id: Date.now(),
                        ...formData,
                        adlCode,
                        status: 'active',
                        clicks: 0,
                        conversions: 0,
                        revenue: 0,
                        createdAt: new Date().toISOString()
                    };
                    
                    const updatedCampaigns = [...campaigns, newCampaign];
                    saveCampaigns(updatedCampaigns);
                    
                    showNotification('Campaign created successfully!');
                    setShowCreateModal(false);
                    setFormData({ name: '', source: '', budget: '', targetUrl: '' });
                };
                
                return (
                    <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
                        <div className="bg-white rounded-xl shadow-2xl max-w-md w-full max-h-[90vh] overflow-y-auto">
                            <div className="p-6">
                                <div className="flex justify-between items-center mb-6">
                                    <h2 className="text-2xl font-bold text-gray-900">Create Campaign</h2>
                                    <button
                                        onClick={() => setShowCreateModal(false)}
                                        className="text-gray-400 hover:text-gray-600"
                                    >
                                        <icons.X className="w-6 h-6" />
                                    </button>
                                </div>
                                
                                <form onSubmit={handleSubmit} className="space-y-4">
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-1">
                                            Campaign Name
                                        </label>
                                        <input
                                            type="text"
                                            required
                                            value={formData.name}
                                            onChange={(e) => setFormData({...formData, name: e.target.value})}
                                            className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                            placeholder="Summer Sale 2024"
                                        />
                                    </div>
                                    
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-1">
                                            Ad Platform
                                        </label>
                                        <select
                                            required
                                            value={formData.source}
                                            onChange={(e) => setFormData({...formData, source: e.target.value})}
                                            className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                        >
                                            <option value="">Select Platform</option>
                                            {platforms.map(platform => (
                                                <option key={platform} value={platform}>{platform}</option>
                                            ))}
                                        </select>
                                    </div>
                                    
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-1">
                                            Budget ($)
                                        </label>
                                        <input
                                            type="number"
                                            required
                                            min="1"
                                            value={formData.budget}
                                            onChange={(e) => setFormData({...formData, budget: e.target.value})}
                                            className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                            placeholder="1000"
                                        />
                                    </div>
                                    
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-1">
                                            Target URL
                                        </label>
                                        <input
                                            type="url"
                                            required
                                            value={formData.targetUrl}
                                            onChange={(e) => setFormData({...formData, targetUrl: e.target.value})}
                                            className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                            placeholder="https://yoursite.com/landing"
                                        />
                                    </div>
                                    
                                    {adlCode && (
                                        <div className="bg-blue-50 p-4 rounded-lg">
                                            <div className="flex items-center justify-between mb-2">
                                                <span className="text-sm font-medium text-blue-900">Your ADL Code:</span>
                                                <button
                                                    type="button"
                                                    onClick={() => {
                                                        navigator.clipboard.writeText(adlCode);
                                                        showNotification('Code copied!');
                                                    }}
                                                    className="text-blue-600 hover:text-blue-800"
                                                >
                                                    <icons.Copy className="w-4 h-4" />
                                                </button>
                                            </div>
                                            <code className="text-lg font-mono text-blue-600">{adlCode}</code>
                                        </div>
                                    )}
                                    
                                    <div className="bg-green-50 p-4 rounded-lg">
                                        <div className="flex items-center">
                                            <icons.Check className="w-5 h-5 text-green-600 mr-2" />
                                            <span className="text-sm text-green-800">
                                                Tracks conversions across ALL platforms automatically
                                            </span>
                                        </div>
                                    </div>
                                    
                                    <button
                                        type="submit"
                                        className="w-full bg-blue-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-blue-700 transition-colors"
                                    >
                                        Create Campaign
                                    </button>
                                </form>
                            </div>
                        </div>
                    </div>
                );
            };
            
            // Analytics Modal
            const AnalyticsModal = ({ campaign }) => {
                const conversionRate = campaign.clicks > 0 ? (campaign.conversions / campaign.clicks * 100).toFixed(2) : 0;
                const roi = campaign.budget > 0 ? ((campaign.revenue - campaign.budget) / campaign.budget * 100).toFixed(2) : 0;
                
                return (
                    <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
                        <div className="bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto">
                            <div className="p-6">
                                <div className="flex justify-between items-center mb-6">
                                    <h2 className="text-2xl font-bold text-gray-900">Campaign Analytics</h2>
                                    <button
                                        onClick={() => setShowAnalyticsModal(false)}
                                        className="text-gray-400 hover:text-gray-600"
                                    >
                                        <icons.X className="w-6 h-6" />
                                    </button>
                                </div>
                                
                                <div className="space-y-6">
                                    <div>
                                        <h3 className="text-lg font-semibold mb-2">{campaign.name}</h3>
                                        <p className="text-gray-600">ADL Code: {campaign.adlCode}</p>
                                    </div>
                                    
                                    <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                                        <div className="bg-blue-50 p-4 rounded-lg">
                                            <div className="flex items-center mb-2">
                                                <icons.MousePointer className="w-5 h-5 text-blue-600 mr-2" />
                                                <span className="text-sm text-gray-600">Clicks</span>
                                            </div>
                                            <p className="text-2xl font-bold text-gray-900">{campaign.clicks}</p>
                                        </div>
                                        
                                        <div className="bg-green-50 p-4 rounded-lg">
                                            <div className="flex items-center mb-2">
                                                <icons.Target className="w-5 h-5 text-green-600 mr-2" />
                                                <span className="text-sm text-gray-600">Conversions</span>
                                            </div>
                                            <p className="text-2xl font-bold text-gray-900">{campaign.conversions}</p>
                                        </div>
                                        
                                        <div className="bg-yellow-50 p-4 rounded-lg">
                                            <div className="flex items-center mb-2">
                                                <icons.DollarSign className="w-5 h-5 text-yellow-600 mr-2" />
                                                <span className="text-sm text-gray-600">Revenue</span>
                                            </div>
                                            <p className="text-2xl font-bold text-gray-900">${campaign.revenue.toFixed(2)}</p>
                                        </div>
                                        
                                        <div className="bg-purple-50 p-4 rounded-lg">
                                            <div className="flex items-center mb-2">
                                                <icons.TrendingUp className="w-5 h-5 text-purple-600 mr-2" />
                                                <span className="text-sm text-gray-600">ROI</span>
                                            </div>
                                            <p className="text-2xl font-bold text-gray-900">{roi}%</p>
                                        </div>
                                    </div>
                                    
                                    <div className="bg-gray-50 p-4 rounded-lg">
                                        <h4 className="font-semibold mb-2">Tracking Code</h4>
                                        <pre className="bg-gray-800 text-white p-4 rounded-lg text-xs overflow-x-auto">
{`<script>
window.ADL = {
  track: function(event, data) {
    fetch('https://track.addatalogic.com/api/track/${campaign.adlCode}', {
      method: 'POST',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify({
        event: event || 'conversion',
        url: window.location.href,
        timestamp: Date.now(),
        ...data
      })
    });
  }
};
ADL.track('pageview');
</script>`}
                                        </pre>
                                        <button
                                            onClick={() => {
                                                navigator.clipboard.writeText(`<script>window.ADL={track:function(event,data){fetch('https://track.addatalogic.com/api/track/${campaign.adlCode}',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({event:event||'conversion',url:window.location.href,timestamp:Date.now(),...data})})}};ADL.track('pageview');</script>`);
                                                showNotification('Tracking code copied!');
                                            }}
                                            className="mt-2 text-blue-600 hover:text-blue-800 flex items-center"
                                        >
                                            <icons.Copy className="w-4 h-4 mr-1" />
                                            Copy Code
                                        </button>
                                    </div>
                                    
                                    <div className="flex gap-2">
                                        <button
                                            onClick={() => {
                                                const data = `Campaign,Clicks,Conversions,Revenue,ROI\n${campaign.name},${campaign.clicks},${campaign.conversions},${campaign.revenue},${roi}%`;
                                                const blob = new Blob([data], { type: 'text/csv' });
                                                const url = URL.createObjectURL(blob);
                                                const a = document.createElement('a');
                                                a.href = url;
                                                a.download = `${campaign.name}-analytics.csv`;
                                                a.click();
                                                showNotification('Data exported!');
                                            }}
                                            className="flex-1 bg-gray-200 text-gray-800 py-2 px-4 rounded-lg font-medium hover:bg-gray-300 transition-colors flex items-center justify-center"
                                        >
                                            <icons.Download className="w-4 h-4 mr-2" />
                                            Export Data
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                );
            };
            
            // Campaign Card
            const CampaignCard = ({ campaign }) => {
                const conversionRate = campaign.clicks > 0 ? (campaign.conversions / campaign.clicks * 100).toFixed(2) : 0;
                
                return (
                    <div className="bg-white rounded-lg shadow-sm border border-gray-200 p-4 hover:shadow-md transition-shadow">
                        <div className="flex justify-between items-start mb-3">
                            <div>
                                <h3 className="font-semibold text-gray-900">{campaign.name}</h3>
                                <p className="text-sm text-gray-600">{campaign.source}</p>
                                <p className="text-xs text-gray-500 mt-1">Code: {campaign.adlCode}</p>
                            </div>
                            <span className={`px-2 py-1 text-xs rounded-full ${
                                campaign.status === 'active' ? 'bg-green-100 text-green-800' : 'bg-gray-100 text-gray-800'
                            }`}>
                                {campaign.status}
                            </span>
                        </div>
                        
                        <div className="grid grid-cols-3 gap-2 mb-4">
                            <div>
                                <p className="text-xs text-gray-600">Clicks</p>
                                <p className="text-lg font-semibold">{campaign.clicks}</p>
                            </div>
                            <div>
                                <p className="text-xs text-gray-600">Conversions</p>
                                <p className="text-lg font-semibold">{campaign.conversions}</p>
                            </div>
                            <div>
                                <p className="text-xs text-gray-600">Revenue</p>
                                <p className="text-lg font-semibold">${campaign.revenue.toFixed(0)}</p>
                            </div>
                        </div>
                        
                        <div className="flex gap-2">
                            <button
                                onClick={() => {
                                    setSelectedCampaign(campaign);
                                    setShowAnalyticsModal(true);
                                }}
                                className="flex-1 bg-blue-50 text-blue-600 py-2 px-3 rounded-lg text-sm font-medium hover:bg-blue-100 transition-colors flex items-center justify-center"
                            >
                                <icons.Eye className="w-4 h-4 mr-1" />
                                View
                            </button>
                            <button
                                onClick={() => {
                                    const updated = campaigns.map(c => 
                                        c.id === campaign.id ? {...c, status: c.status === 'active' ? 'paused' : 'active'} : c
                                    );
                                    saveCampaigns(updated);
                                    showNotification(`Campaign ${campaign.status === 'active' ? 'paused' : 'resumed'}!`);
                                }}
                                className="bg-gray-50 text-gray-600 py-2 px-3 rounded-lg text-sm font-medium hover:bg-gray-100 transition-colors"
                            >
                                {campaign.status === 'active' ? <icons.Pause className="w-4 h-4" /> : <icons.Play className="w-4 h-4" />}
                            </button>
                            <button
                                onClick={() => {
                                    if (confirm('Delete this campaign?')) {
                                        const updated = campaigns.filter(c => c.id !== campaign.id);
                                        saveCampaigns(updated);
                                        showNotification('Campaign deleted!');
                                    }
                                }}
                                className="bg-red-50 text-red-600 py-2 px-3 rounded-lg text-sm font-medium hover:bg-red-100 transition-colors"
                            >
                                <icons.Trash className="w-4 h-4" />
                            </button>
                        </div>
                    </div>
                );
            };
            
            // Dashboard View
            const DashboardView = () => {
                const totalClicks = campaigns.reduce((sum, c) => sum + c.clicks, 0);
                const totalConversions = campaigns.reduce((sum, c) => sum + c.conversions, 0);
                const totalRevenue = campaigns.reduce((sum, c) => sum + c.revenue, 0);
                const totalBudget = campaigns.reduce((sum, c) => sum + parseFloat(c.budget || 0), 0);
                const overallROI = totalBudget > 0 ? ((totalRevenue - totalBudget) / totalBudget * 100).toFixed(2) : 0;
                
                return (
                    <div className="space-y-6">
                        <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                            <div className="bg-white p-4 rounded-lg shadow-sm border border-gray-200">
                                <div className="flex items-center justify-between mb-2">
                                    <span className="text-sm text-gray-600">Total Clicks</span>
                                    <icons.MousePointer className="w-5 h-5 text-blue-600" />
                                </div>
                                <p className="text-2xl font-bold text-gray-900">{totalClicks}</p>
                            </div>
                            
                            <div className="bg-white p-4 rounded-lg shadow-sm border border-gray-200">
                                <div className="flex items-center justify-between mb-2">
                                    <span className="text-sm text-gray-600">Conversions</span>
                                    <icons.Target className="w-5 h-5 text-green-600" />
                                </div>
                                <p className="text-2xl font-bold text-gray-900">{totalConversions}</p>
                            </div>
                            
                            <div className="bg-white p-4 rounded-lg shadow-sm border border-gray-200">
                                <div className="flex items-center justify-between mb-2">
                                    <span className="text-sm text-gray-600">Revenue</span>
                                    <icons.DollarSign className="w-5 h-5 text-yellow-600" />
                                </div>
                                <p className="text-2xl font-bold text-gray-900">${totalRevenue.toFixed(2)}</p>
                            </div>
                            
                            <div className="bg-white p-4 rounded-lg shadow-sm border border-gray-200">
                                <div className="flex items-center justify-between mb-2">
                                    <span className="text-sm text-gray-600">Overall ROI</span>
                                    <icons.TrendingUp className="w-5 h-5 text-purple-600" />
                                </div>
                                <p className="text-2xl font-bold text-gray-900">{overallROI}%</p>
                            </div>
                        </div>
                        
                        <div className="flex justify-between items-center">
                            <h2 className="text-xl font-bold text-gray-900">Active Campaigns</h2>
                            <button
                                onClick={() => {
                                    setIsLoading(true);
                                    setTimeout(() => {
                                        updateMetrics();
                                        setIsLoading(false);
                                        showNotification('Data refreshed!');
                                    }, 1000);
                                }}
                                className="text-blue-600 hover:text-blue-800 flex items-center"
                            >
                                <icons.RefreshCw className={`w-4 h-4 mr-1 ${isLoading ? 'animate-spin' : ''}`} />
                                Refresh
                            </button>
                        </div>
                        
                        {campaigns.length === 0 ? (
                            <div className="bg-white rounded-lg p-8 text-center border-2 border-dashed border-gray-300">
                                <icons.BarChart className="w-12 h-12 text-gray-400 mx-auto mb-4" />
                                <h3 className="text-lg font-medium text-gray-900 mb-2">No campaigns yet</h3>
                                <p className="text-gray-600 mb-4">Create your first campaign to start tracking</p>
                                <button
                                    onClick={() => setShowCreateModal(true)}
                                    className="bg-blue-600 text-white py-2 px-4 rounded-lg font-medium hover:bg-blue-700 transition-colors inline-flex items-center"
                                >
                                    <icons.Plus className="w-4 h-4 mr-2" />
                                    Create Campaign
                                </button>
                            </div>
                        ) : (
                            <div className="grid gap-4 md:grid-cols-2 lg:grid-cols-3">
                                {campaigns.map(campaign => (
                                    <CampaignCard key={campaign.id} campaign={campaign} />
                                ))}
                            </div>
                        )}
                    </div>
                );
            };
            
            // Settings View
            const SettingsView = () => {
                return (
                    <div className="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
                        <h2 className="text-xl font-bold text-gray-900 mb-6">Settings</h2>
                        
                        <div className="space-y-6">
                            <div>
                                <h3 className="text-lg font-semibold mb-3">Account</h3>
                                <div className="space-y-3">
                                    <div className="flex justify-between items-center">
                                        <span className="text-gray-700">Email Notifications</span>
                                        <input type="checkbox" className="w-4 h-4" defaultChecked />
                                    </div>
                                    <div className="flex justify-between items-center">
                                        <span className="text-gray-700">Weekly Reports
